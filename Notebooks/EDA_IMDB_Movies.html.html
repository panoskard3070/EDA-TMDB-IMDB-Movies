<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>bf483336b4874b27a7ebe78245f534ac</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<div class="cell markdown" id="aVmDlyjT-kud">
<p>#<strong>IMDB Data Analysis of 1M Movies (EDA)</strong>
<strong>Author:</strong> <code>Panagiotis Kardatos</code></p>
<p><strong>Date:</strong> <code>Mid October 2025</code></p>
<p>The main objective of this project is to find out how the film
industry has evolved over time in terms of commercial success, quality
and theamatic diversity. Through of TMDB and IMDB datasets we aim to
uncover patterns and trends related to genres, ratings, revenue and
audience preferences across decades.</p>
</div>
<div class="cell markdown" id="-D4NOliYB_Eq">
<p>##<strong>Step 1: Data Import and Setup</strong></p>
<p>At this step we will import:</p>
<ul>
<li>The required libraries for the project</li>
<li>Acquire the dataset(s)</li>
<li>Setting up the initial DataFrame</li>
</ul>
</div>
<div class="cell code" data-execution_count="148"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="HjKFZE5tC5u_" data-outputId="5f742dee-b483-4a07-ae53-bae22ba20e0a">
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Install Kaggle</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install Kaggle</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Requirement already satisfied: Kaggle in /usr/local/lib/python3.12/dist-packages (1.7.4.5)
Requirement already satisfied: bleach in /usr/local/lib/python3.12/dist-packages (from Kaggle) (6.2.0)
Requirement already satisfied: certifi&gt;=14.05.14 in /usr/local/lib/python3.12/dist-packages (from Kaggle) (2025.10.5)
Requirement already satisfied: charset-normalizer in /usr/local/lib/python3.12/dist-packages (from Kaggle) (3.4.3)
Requirement already satisfied: idna in /usr/local/lib/python3.12/dist-packages (from Kaggle) (3.10)
Requirement already satisfied: protobuf in /usr/local/lib/python3.12/dist-packages (from Kaggle) (5.29.5)
Requirement already satisfied: python-dateutil&gt;=2.5.3 in /usr/local/lib/python3.12/dist-packages (from Kaggle) (2.9.0.post0)
Requirement already satisfied: python-slugify in /usr/local/lib/python3.12/dist-packages (from Kaggle) (8.0.4)
Requirement already satisfied: requests in /usr/local/lib/python3.12/dist-packages (from Kaggle) (2.32.4)
Requirement already satisfied: setuptools&gt;=21.0.0 in /usr/local/lib/python3.12/dist-packages (from Kaggle) (75.2.0)
Requirement already satisfied: six&gt;=1.10 in /usr/local/lib/python3.12/dist-packages (from Kaggle) (1.17.0)
Requirement already satisfied: text-unidecode in /usr/local/lib/python3.12/dist-packages (from Kaggle) (1.3)
Requirement already satisfied: tqdm in /usr/local/lib/python3.12/dist-packages (from Kaggle) (4.67.1)
Requirement already satisfied: urllib3&gt;=1.15.1 in /usr/local/lib/python3.12/dist-packages (from Kaggle) (2.5.0)
Requirement already satisfied: webencodings in /usr/local/lib/python3.12/dist-packages (from Kaggle) (0.5.1)
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="149"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="8Ybo_QfpDQM7" data-outputId="9e233c4b-9f7a-4e5e-dc3c-0dab410ed485">
<div class="sourceCode" id="cb3"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Install Kagglehub</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install kagglehub</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Requirement already satisfied: kagglehub in /usr/local/lib/python3.12/dist-packages (0.3.13)
Requirement already satisfied: packaging in /usr/local/lib/python3.12/dist-packages (from kagglehub) (25.0)
Requirement already satisfied: pyyaml in /usr/local/lib/python3.12/dist-packages (from kagglehub) (6.0.3)
Requirement already satisfied: requests in /usr/local/lib/python3.12/dist-packages (from kagglehub) (2.32.4)
Requirement already satisfied: tqdm in /usr/local/lib/python3.12/dist-packages (from kagglehub) (4.67.1)
Requirement already satisfied: charset_normalizer&lt;4,&gt;=2 in /usr/local/lib/python3.12/dist-packages (from requests-&gt;kagglehub) (3.4.3)
Requirement already satisfied: idna&lt;4,&gt;=2.5 in /usr/local/lib/python3.12/dist-packages (from requests-&gt;kagglehub) (3.10)
Requirement already satisfied: urllib3&lt;3,&gt;=1.21.1 in /usr/local/lib/python3.12/dist-packages (from requests-&gt;kagglehub) (2.5.0)
Requirement already satisfied: certifi&gt;=2017.4.17 in /usr/local/lib/python3.12/dist-packages (from requests-&gt;kagglehub) (2025.10.5)
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="150" id="KZ9ehjVQC_lk">
<div class="sourceCode" id="cb5"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Importing the Libraries</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> kagglehub <span class="im">as</span> kh</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="151"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="QTtzBHgRD2d6" data-outputId="bd1eefd1-9b64-40ec-e2f7-93dc82757733">
<div class="sourceCode" id="cb6"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Folder Path</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>path<span class="op">=</span>kh.dataset_download(<span class="st">&quot;alanvourch/tmdb-movies-daily-updates&quot;</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(path)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Using Colab cache for faster access to the &#39;tmdb-movies-daily-updates&#39; dataset.
/kaggle/input/tmdb-movies-daily-updates
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="152"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="hVPCq6VoEFjj" data-outputId="a931a9ae-e702-4843-e21b-8f9391cfc80d">
<div class="sourceCode" id="cb8"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Full File Path</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>file_path<span class="op">=</span>os.path.join(path, <span class="st">&quot;TMDB_all_movies.csv&quot;</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(file_path)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>/kaggle/input/tmdb-movies-daily-updates/TMDB_all_movies.csv
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="153" id="US-hrOYtH-mz">
<div class="sourceCode" id="cb10"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating the DataFrame</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>df<span class="op">=</span>pd.read_csv(file_path, sep<span class="op">=</span><span class="st">&#39;,&#39;</span>)</span></code></pre></div>
</div>
<div class="cell markdown" id="z3I48v4pMesU">
<p>##<strong>Step 2: Data Inspection</strong> At this step we will
get:</p>
<ul>
<li>A first view of the dataset</li>
<li>Spot the shape, and gather some first info</li>
<li>Search for any missing values</li>
</ul>
<p>This procedure will help us a lot to understand the dataset so we can
proceed with the next step Data Cleaning.</p>
</div>
<div class="cell code" data-execution_count="154" id="9uxs7BAcOcGN">
<div class="sourceCode" id="cb11"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#We &#39;ll leave the original DataFrame intact</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>df1 <span class="op">=</span> df.copy()</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="155"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:0}"
id="1j5KdG3COnBE" data-outputId="1e865985-0b11-4c80-c4fe-ab37ebe28fdd">
<div class="sourceCode" id="cb12"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">#First Rows</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>df1.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="155">

  <div id="df-71a4d2f1-a4bd-4328-8827-c7b91511f315" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>title</th>
      <th>vote_average</th>
      <th>vote_count</th>
      <th>status</th>
      <th>release_date</th>
      <th>revenue</th>
      <th>runtime</th>
      <th>budget</th>
      <th>imdb_id</th>
      <th>...</th>
      <th>spoken_languages</th>
      <th>cast</th>
      <th>director</th>
      <th>director_of_photography</th>
      <th>writers</th>
      <th>producers</th>
      <th>music_composer</th>
      <th>imdb_rating</th>
      <th>imdb_votes</th>
      <th>poster_path</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2</td>
      <td>Ariel</td>
      <td>7.100</td>
      <td>356.0</td>
      <td>Released</td>
      <td>1988-10-21</td>
      <td>0.0</td>
      <td>73.0</td>
      <td>0.0</td>
      <td>tt0094675</td>
      <td>...</td>
      <td>suomi</td>
      <td>Susanna Haavisto, Pentti Auer, Olli Varja, Mer...</td>
      <td>Aki Kaurismäki</td>
      <td>Timo Salminen</td>
      <td>Aki Kaurismäki</td>
      <td>Aki Kaurismäki</td>
      <td>NaN</td>
      <td>7.4</td>
      <td>9426.0</td>
      <td>/ojDg0PGvs6R9xYFodRct2kdI6wC.jpg</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>Shadows in Paradise</td>
      <td>7.290</td>
      <td>416.0</td>
      <td>Released</td>
      <td>1986-10-17</td>
      <td>0.0</td>
      <td>74.0</td>
      <td>0.0</td>
      <td>tt0092149</td>
      <td>...</td>
      <td>suomi, English, svenska</td>
      <td>Kylli Köngäs, Esko Nikkari, Marina Martinoff, ...</td>
      <td>Aki Kaurismäki</td>
      <td>Timo Salminen</td>
      <td>Aki Kaurismäki</td>
      <td>Mika Kaurismäki</td>
      <td>NaN</td>
      <td>7.4</td>
      <td>8276.0</td>
      <td>/nj01hspawPof0mJmlgfjuLyJuRN.jpg</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5</td>
      <td>Four Rooms</td>
      <td>5.869</td>
      <td>2736.0</td>
      <td>Released</td>
      <td>1995-12-09</td>
      <td>4257354.0</td>
      <td>98.0</td>
      <td>4000000.0</td>
      <td>tt0113101</td>
      <td>...</td>
      <td>English</td>
      <td>Lawrence Bender, Valeria Golino, Jennifer Beal...</td>
      <td>Robert Rodriguez, Allison Anders, Quentin Tara...</td>
      <td>Andrzej Sekula, Phil Parmet, Guillermo Navarro...</td>
      <td>Robert Rodriguez, Allison Anders, Quentin Tara...</td>
      <td>Quentin Tarantino, Alexandre Rockwell, Lawrenc...</td>
      <td>Combustible Edison</td>
      <td>6.7</td>
      <td>115301.0</td>
      <td>/75aHn1NOYXh4M7L5shoeQ6NGykP.jpg</td>
    </tr>
    <tr>
      <th>3</th>
      <td>6</td>
      <td>Judgment Night</td>
      <td>6.500</td>
      <td>360.0</td>
      <td>Released</td>
      <td>1993-10-15</td>
      <td>12136938.0</td>
      <td>109.0</td>
      <td>21000000.0</td>
      <td>tt0107286</td>
      <td>...</td>
      <td>English</td>
      <td>Doug Wert, Angela Alvarado, Everlast, Sean O'G...</td>
      <td>Stephen Hopkins</td>
      <td>Peter Levy</td>
      <td>Lewis Colick, Jere Cunningham</td>
      <td>Marilyn Vance, Gene Levy, Lloyd Segan</td>
      <td>Alan Silvestri</td>
      <td>6.6</td>
      <td>20447.0</td>
      <td>/3rvvpS9YPM5HB2f4HYiNiJVtdam.jpg</td>
    </tr>
    <tr>
      <th>4</th>
      <td>8</td>
      <td>Life in Loops (A Megacities RMX)</td>
      <td>7.500</td>
      <td>27.0</td>
      <td>Released</td>
      <td>2006-01-01</td>
      <td>0.0</td>
      <td>80.0</td>
      <td>42000.0</td>
      <td>tt0825671</td>
      <td>...</td>
      <td>English, हिन्दी, 日本語, Pусский, Español</td>
      <td>NaN</td>
      <td>Timo Novotny</td>
      <td>Wolfgang Thaler</td>
      <td>Michael Glawogger, Timo Novotny</td>
      <td>Ulrich Gehmacher, Timo Novotny</td>
      <td>NaN</td>
      <td>8.1</td>
      <td>285.0</td>
      <td>/7ln81BRnPR2wqxuITZxEciCe1lc.jpg</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 28 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-71a4d2f1-a4bd-4328-8827-c7b91511f315')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-71a4d2f1-a4bd-4328-8827-c7b91511f315 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-71a4d2f1-a4bd-4328-8827-c7b91511f315');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-29c2ec63-1f42-48e0-af47-13b50323acf3">
      <button class="colab-df-quickchart" onclick="quickchart('df-29c2ec63-1f42-48e0-af47-13b50323acf3')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-29c2ec63-1f42-48e0-af47-13b50323acf3 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="156"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="iEtdeWXBPT6p" data-outputId="a743ed45-4613-4260-8183-53f6f85bfb37">
<div class="sourceCode" id="cb13"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Shape</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>df1.shape</span></code></pre></div>
<div class="output execute_result" data-execution_count="156">
<pre><code>(1116358, 28)</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="157"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="sS4vWcgKPz-w" data-outputId="1475c9be-2ee7-4bc5-f5b7-04e92fc96a31">
<div class="sourceCode" id="cb15"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#General Info</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>df1.info()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 1116358 entries, 0 to 1116357
Data columns (total 28 columns):
 #   Column                   Non-Null Count    Dtype  
---  ------                   --------------    -----  
 0   id                       1116358 non-null  int64  
 1   title                    1116343 non-null  object 
 2   vote_average             1116358 non-null  float64
 3   vote_count               1116358 non-null  float64
 4   status                   1116358 non-null  object 
 5   release_date             1001302 non-null  object 
 6   revenue                  1116358 non-null  float64
 7   runtime                  1116358 non-null  float64
 8   budget                   1116358 non-null  float64
 9   imdb_id                  635244 non-null   object 
 10  original_language        1116358 non-null  object 
 11  original_title           1116343 non-null  object 
 12  overview                 942727 non-null   object 
 13  popularity               1116358 non-null  float64
 14  tagline                  167602 non-null   object 
 15  genres                   810593 non-null   object 
 16  production_companies     532068 non-null   object 
 17  production_countries     693020 non-null   object 
 18  spoken_languages         704850 non-null   object 
 19  cast                     758069 non-null   object 
 20  director                 933946 non-null   object 
 21  director_of_photography  290316 non-null   object 
 22  writers                  559478 non-null   object 
 23  producers                374463 non-null   object 
 24  music_composer           121492 non-null   object 
 25  imdb_rating              455318 non-null   float64
 26  imdb_votes               455318 non-null   float64
 27  poster_path              834602 non-null   object 
dtypes: float64(8), int64(1), object(19)
memory usage: 238.5+ MB
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="158"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:0}"
id="yKy2keyBRE7R" data-outputId="5a820a7e-2ac2-418e-ad1c-2aa0eed2eceb">
<div class="sourceCode" id="cb17"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Νull Values per column</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>df1.isnull().<span class="bu">sum</span>()</span></code></pre></div>
<div class="output execute_result" data-execution_count="158">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id</th>
      <td>0</td>
    </tr>
    <tr>
      <th>title</th>
      <td>15</td>
    </tr>
    <tr>
      <th>vote_average</th>
      <td>0</td>
    </tr>
    <tr>
      <th>vote_count</th>
      <td>0</td>
    </tr>
    <tr>
      <th>status</th>
      <td>0</td>
    </tr>
    <tr>
      <th>release_date</th>
      <td>115056</td>
    </tr>
    <tr>
      <th>revenue</th>
      <td>0</td>
    </tr>
    <tr>
      <th>runtime</th>
      <td>0</td>
    </tr>
    <tr>
      <th>budget</th>
      <td>0</td>
    </tr>
    <tr>
      <th>imdb_id</th>
      <td>481114</td>
    </tr>
    <tr>
      <th>original_language</th>
      <td>0</td>
    </tr>
    <tr>
      <th>original_title</th>
      <td>15</td>
    </tr>
    <tr>
      <th>overview</th>
      <td>173631</td>
    </tr>
    <tr>
      <th>popularity</th>
      <td>0</td>
    </tr>
    <tr>
      <th>tagline</th>
      <td>948756</td>
    </tr>
    <tr>
      <th>genres</th>
      <td>305765</td>
    </tr>
    <tr>
      <th>production_companies</th>
      <td>584290</td>
    </tr>
    <tr>
      <th>production_countries</th>
      <td>423338</td>
    </tr>
    <tr>
      <th>spoken_languages</th>
      <td>411508</td>
    </tr>
    <tr>
      <th>cast</th>
      <td>358289</td>
    </tr>
    <tr>
      <th>director</th>
      <td>182412</td>
    </tr>
    <tr>
      <th>director_of_photography</th>
      <td>826042</td>
    </tr>
    <tr>
      <th>writers</th>
      <td>556880</td>
    </tr>
    <tr>
      <th>producers</th>
      <td>741895</td>
    </tr>
    <tr>
      <th>music_composer</th>
      <td>994866</td>
    </tr>
    <tr>
      <th>imdb_rating</th>
      <td>661040</td>
    </tr>
    <tr>
      <th>imdb_votes</th>
      <td>661040</td>
    </tr>
    <tr>
      <th>poster_path</th>
      <td>281756</td>
    </tr>
  </tbody>
</table>
</div><br><label><b>dtype:</b> int64</label>
</div>
</div>
<div class="cell markdown" id="36aj4mAUTSG1">
<p>As a first comment, we have a heterogenous dataset and we need to be
<strong>extremely</strong> carefull at the next step (Data Cleaning) as
a single .dropna() can delete up to 992.412 rows.</p>
</div>
<div class="cell markdown" id="tbWtYmbvRDS-">
<p>##<strong>Step 3: Data Cleaning</strong></p>
<p>At this step we will drop and manipulate the data that will affect
the overall dataset's analysis. We will check:</p>
<ul>
<li>Missing Values</li>
<li>Duplicate Entries</li>
<li>Ensure columns have the correct data type</li>
</ul>
</div>
<div class="cell markdown" id="IK-RTYD6E6Po">
<p>###<strong>Initial Work</strong></p>
</div>
<div class="cell markdown" id="f9sK5n4p6gjG">
<p>As we see diffrent columns have diffrent number of NA's. This means
that in order to examine the dataset in a specific feature we need to
break the original dataframe to more than one, otherwise by simply
wiping hundrend of thousands rows we will introduce bias. From the
original dataframe we already have a copy. We will make a second copy as
well. So the original EDA Analysis will be performed in 2 diffrent
dataframes. In the first copied dataframe we absolutely need release
date and genre to find time trends and as many columns as possible and
with the second copied dataframe we will analyze IMDB ratings. Bear in
mind that we will lose thousand of rows from filtering. We will try to
keep as many possible.</p>
</div>
<div class="cell code" data-execution_count="159" id="YtYCS5UE-jcs">
<div class="sourceCode" id="cb18"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Second Copy for IMDB use</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>df2 <span class="op">=</span> df.copy()</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="160"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="xzt96CizfBPS" data-outputId="af4ba85b-8b70-4d9c-a312-252ca58fea91">
<div class="sourceCode" id="cb19"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>df1.info()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 1116358 entries, 0 to 1116357
Data columns (total 28 columns):
 #   Column                   Non-Null Count    Dtype  
---  ------                   --------------    -----  
 0   id                       1116358 non-null  int64  
 1   title                    1116343 non-null  object 
 2   vote_average             1116358 non-null  float64
 3   vote_count               1116358 non-null  float64
 4   status                   1116358 non-null  object 
 5   release_date             1001302 non-null  object 
 6   revenue                  1116358 non-null  float64
 7   runtime                  1116358 non-null  float64
 8   budget                   1116358 non-null  float64
 9   imdb_id                  635244 non-null   object 
 10  original_language        1116358 non-null  object 
 11  original_title           1116343 non-null  object 
 12  overview                 942727 non-null   object 
 13  popularity               1116358 non-null  float64
 14  tagline                  167602 non-null   object 
 15  genres                   810593 non-null   object 
 16  production_companies     532068 non-null   object 
 17  production_countries     693020 non-null   object 
 18  spoken_languages         704850 non-null   object 
 19  cast                     758069 non-null   object 
 20  director                 933946 non-null   object 
 21  director_of_photography  290316 non-null   object 
 22  writers                  559478 non-null   object 
 23  producers                374463 non-null   object 
 24  music_composer           121492 non-null   object 
 25  imdb_rating              455318 non-null   float64
 26  imdb_votes               455318 non-null   float64
 27  poster_path              834602 non-null   object 
dtypes: float64(8), int64(1), object(19)
memory usage: 238.5+ MB
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="161" id="hEOywEhwfBSJ">
<div class="sourceCode" id="cb21"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Dropping Columns</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>df1.drop(columns<span class="op">=</span>[<span class="st">&#39;id&#39;</span>,<span class="st">&#39;imdb_id&#39;</span>,<span class="st">&#39;original_title&#39;</span>,<span class="st">&#39;overview&#39;</span>,<span class="st">&#39;tagline&#39;</span>,</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&#39;production_companies&#39;</span>,<span class="st">&#39;production_countries&#39;</span>,</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&#39;spoken_languages&#39;</span>,<span class="st">&#39;director&#39;</span>,<span class="st">&#39;director_of_photography&#39;</span>,</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&#39;writers&#39;</span>,<span class="st">&#39;producers&#39;</span>,<span class="st">&#39;cast&#39;</span>,<span class="st">&#39;music_composer&#39;</span>,<span class="st">&#39;imdb_rating&#39;</span>,</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&#39;imdb_votes&#39;</span>,<span class="st">&#39;poster_path&#39;</span>], inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>df2.drop(columns<span class="op">=</span>[<span class="st">&#39;id&#39;</span>,<span class="st">&#39;vote_average&#39;</span>,<span class="st">&#39;vote_count&#39;</span>,<span class="st">&#39;revenue&#39;</span>,<span class="st">&#39;budget&#39;</span>,<span class="st">&#39;imdb_id&#39;</span>,</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&#39;original_title&#39;</span>,<span class="st">&#39;overview&#39;</span>,<span class="st">&#39;tagline&#39;</span>,<span class="st">&#39;spoken_languages&#39;</span>,</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&#39;director_of_photography&#39;</span>,<span class="st">&#39;producers&#39;</span>,<span class="st">&#39;music_composer&#39;</span>,</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&#39;popularity&#39;</span>,<span class="st">&#39;poster_path&#39;</span>], inplace<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="162"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="Hq5G9o-JfBUh" data-outputId="1c46974a-21fd-48d9-c9ac-9e2a73e401d3">
<div class="sourceCode" id="cb22"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Current information</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;</span><span class="sc">{</span>df1<span class="sc">.</span>info()<span class="sc">}</span><span class="ss"> </span><span class="ch">\n</span><span class="ss"> </span><span class="ch">\n</span><span class="ss"> </span><span class="ch">\n</span><span class="ss"> </span><span class="sc">{</span>df2<span class="sc">.</span>info()<span class="sc">}</span><span class="ss">&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 1116358 entries, 0 to 1116357
Data columns (total 11 columns):
 #   Column             Non-Null Count    Dtype  
---  ------             --------------    -----  
 0   title              1116343 non-null  object 
 1   vote_average       1116358 non-null  float64
 2   vote_count         1116358 non-null  float64
 3   status             1116358 non-null  object 
 4   release_date       1001302 non-null  object 
 5   revenue            1116358 non-null  float64
 6   runtime            1116358 non-null  float64
 7   budget             1116358 non-null  float64
 8   original_language  1116358 non-null  object 
 9   popularity         1116358 non-null  float64
 10  genres             810593 non-null   object 
dtypes: float64(6), object(5)
memory usage: 93.7+ MB
&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 1116358 entries, 0 to 1116357
Data columns (total 13 columns):
 #   Column                Non-Null Count    Dtype  
---  ------                --------------    -----  
 0   title                 1116343 non-null  object 
 1   status                1116358 non-null  object 
 2   release_date          1001302 non-null  object 
 3   runtime               1116358 non-null  float64
 4   original_language     1116358 non-null  object 
 5   genres                810593 non-null   object 
 6   production_companies  532068 non-null   object 
 7   production_countries  693020 non-null   object 
 8   cast                  758069 non-null   object 
 9   director              933946 non-null   object 
 10  writers               559478 non-null   object 
 11  imdb_rating           455318 non-null   float64
 12  imdb_votes            455318 non-null   float64
dtypes: float64(3), object(10)
memory usage: 110.7+ MB
None 
 
 
 None
</code></pre>
</div>
</div>
<div class="cell markdown" id="Amke9Vcfkjf3">
<p>Many movies may have 0 as value in columns such as runtime, revenue
and budget. This indicates that we have null values or theese values are
unknown. At first we will keep all movies that have have an actual
runtime value in both dataframes. This is going to be the first step of
filtering applied to both dataframes.</p>
</div>
<div class="cell code" data-execution_count="163" id="fceXMMQ3fBap">
<div class="sourceCode" id="cb24"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Runtime Filtering</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>df1 <span class="op">=</span> df1[df1[<span class="st">&#39;runtime&#39;</span>]<span class="op">&gt;</span><span class="dv">0</span>]</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>df2 <span class="op">=</span> df2[df2[<span class="st">&#39;runtime&#39;</span>]<span class="op">&gt;</span><span class="dv">0</span>]</span></code></pre></div>
</div>
<div class="cell markdown" id="cNGlQ12XFLSy">
<p>###<strong>EDA1 - Movie characteristics &amp; production analysis
(DataFrame1 Cleaning)</strong></p>
</div>
<div class="cell markdown" id="QG9a1jpLmwir">
<p>Here we will verify how many movies have positive revenue and budget
as this will affect the the economical analysis.</p>
</div>
<div class="cell code" data-execution_count="164"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="YGIrk7nN8UUD" data-outputId="65cd5f8f-4016-4612-c7a3-f08841017935">
<div class="sourceCode" id="cb25"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Verification</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;There are </span><span class="sc">{</span>((df1[<span class="st">&#39;revenue&#39;</span>]<span class="op">&gt;</span><span class="dv">0</span>)<span class="op">&amp;</span>(df1[<span class="st">&#39;budget&#39;</span>]<span class="op">&gt;</span><span class="dv">0</span>))<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">}</span><span class="ss"> with positive revenue and budget and </span><span class="sc">{</span>((df1[<span class="st">&#39;revenue&#39;</span>]<span class="op">==</span><span class="dv">0</span>)<span class="op">&amp;</span>(df1[<span class="st">&#39;budget&#39;</span>]<span class="op">==</span><span class="dv">0</span>))<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">}</span><span class="ss"> with zero revenue and budget&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>There are 15311 with positive revenue and budget and 789241 with zero revenue and budget
</code></pre>
</div>
</div>
<div class="cell markdown" id="uD5JKL7YoowU">
<p>Clearly we will make 2 more sub-dataframes of df1, as a single
replace of 0 with np.nan followed by dropna can eliminate up to 788k
rows. First will be for general analysis and the second for economic
analysis.</p>
</div>
<div class="cell code" data-execution_count="165" id="6xBnK91ZmkUM">
<div class="sourceCode" id="cb27"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Sub DataFrames</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>df1_1 <span class="op">=</span> df1.drop(columns<span class="op">=</span>[<span class="st">&#39;revenue&#39;</span>,<span class="st">&#39;budget&#39;</span>]) <span class="co">#For General Analysis</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>df1_2 <span class="op">=</span> df1[(df1[<span class="st">&#39;revenue&#39;</span>]<span class="op">&gt;</span><span class="dv">0</span>)<span class="op">&amp;</span>(df1[<span class="st">&#39;budget&#39;</span>]<span class="op">&gt;</span><span class="dv">0</span>)] <span class="co">#For Economic Analysis</span></span></code></pre></div>
</div>
<div class="cell markdown" id="QIqfR3-S1bwu">
<p>We will drop NA's from title, release date and genre as this can
affect overall analysis for df1_1. Same thing for df1_2.</p>
</div>
<div class="cell code" data-execution_count="166"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="2nFUcx6Z1sR3" data-outputId="9bbc575a-f6d0-4591-9043-971f82c44064">
<div class="sourceCode" id="cb28"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Dropping NA&#39;s</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>df1_1.dropna(subset<span class="op">=</span>[<span class="st">&#39;title&#39;</span>,<span class="st">&#39;release_date&#39;</span>,<span class="st">&#39;genres&#39;</span>],inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>df1_2.dropna(subset<span class="op">=</span>[<span class="st">&#39;title&#39;</span>,<span class="st">&#39;release_date&#39;</span>,<span class="st">&#39;genres&#39;</span>],inplace<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/tmp/ipython-input-2158141681.py:3: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df1_2.dropna(subset=[&#39;title&#39;,&#39;release_date&#39;,&#39;genres&#39;],inplace=True)
</code></pre>
</div>
</div>
<div class="cell markdown" id="C3t2r1j_qiRp">
<p>Now we will check for duplicates but since the dataset is too large
we will also make a manual inspection to verify the results.</p>
</div>
<div class="cell code" data-execution_count="167"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="ZlNuObZtmkXE" data-outputId="3345cafd-8473-4ac8-ae3a-4d21ab02e3d8">
<div class="sourceCode" id="cb30"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Duplication Check</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;There are </span><span class="sc">{</span>df1_1<span class="sc">.</span>duplicated()<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">}</span><span class="ss"> duplicated rows for df1_1 and </span><span class="sc">{</span>df1_2<span class="sc">.</span>duplicated()<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">}</span><span class="ss"> for df1_2&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>There are 11 duplicated rows for df1_1 and 0 for df1_2
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="168"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="-LNjGJEEqiHh" data-outputId="783292af-e40a-413e-8896-d8c9fe76be2f">
<div class="sourceCode" id="cb32"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Manual Inspection</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> df1_1.index[df1_1.duplicated(keep<span class="op">=</span><span class="va">False</span>)].tolist() <span class="co">#Create list with indexes of duplicated rows for df1_1</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>B <span class="op">=</span> df1_2.index[df1_2.duplicated(keep<span class="op">=</span><span class="va">False</span>)].tolist() <span class="co">#Create list with indexes of duplicated rows for df1_2</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating Loops for both DataFrames</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;The duplicate pairs for df1_1 are:&#39;</span>)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(A)): <span class="co">#For DataFrame1_1</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i<span class="op">+</span><span class="dv">1</span>,<span class="bu">len</span>(A)):</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> df1_1.loc[A[i]].equals(df1_1.loc[A[j]]):</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>      <span class="bu">print</span>(A[i],A[j])</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;The duplicate pairs for df1_2 are:&#39;</span>)</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(B)): <span class="co">#For DataFrame1_2</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i<span class="op">+</span><span class="dv">1</span>,<span class="bu">len</span>(B)):</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> df1_1.loc[B[i]].equals(df1_1.loc[B[j]]):</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>      <span class="bu">print</span>(B[i],B[j])</span></code></pre></div>
<div class="output stream stdout">
<pre><code>The duplicate pairs for df1_1 are:
290514 577634
432434 637010
489567 801706
496722 496731
555625 798407
610131 610140
685451 685457
789039 918302
807839 807849
834800 862353
845906 845909
The duplicate pairs for df1_2 are:
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="169"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="1_VWtT3zrxns" data-outputId="cbea85ee-70b8-4690-fad3-126e018d0f98">
<div class="sourceCode" id="cb34"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Duplicates Validation</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;</span><span class="sc">{</span>df1_1<span class="sc">.</span>loc[<span class="dv">290514</span>]<span class="sc">}</span><span class="ch">\n</span><span class="ss"> </span><span class="ch">\n</span><span class="ss"> </span><span class="ch">\n</span><span class="sc">{</span>df1_1<span class="sc">.</span>loc[<span class="dv">577634</span>]<span class="sc">}</span><span class="ss"> A duplicate pair for df1_1&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>title                Hubble&#39;s Final Frontier
vote_average                             0.0
vote_count                               0.0
status                              Released
release_date                      2009-01-23
runtime                                 45.0
original_language                         en
popularity                               0.6
genres                           Documentary
Name: 290514, dtype: object
 
 
title                Hubble&#39;s Final Frontier
vote_average                             0.0
vote_count                               0.0
status                              Released
release_date                      2009-01-23
runtime                                 45.0
original_language                         en
popularity                               0.6
genres                           Documentary
Name: 577634, dtype: object A duplicate pair for df1_1
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="170"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="LaL-QJMUzBI7" data-outputId="717d1de4-166b-4184-87aa-4005ad13781e">
<div class="sourceCode" id="cb36"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Dropping Duplicates</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>df1_1.drop_duplicates(keep<span class="op">=</span><span class="st">&#39;first&#39;</span>,inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>df1_2.drop_duplicates(keep<span class="op">=</span><span class="st">&#39;first&#39;</span>,inplace<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/tmp/ipython-input-3181184797.py:3: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df1_2.drop_duplicates(keep=&#39;first&#39;,inplace=True)
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="171" id="HeODYd_k0M8R">
<div class="sourceCode" id="cb38"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Resetting Index</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>df1_1.reset_index(drop<span class="op">=</span><span class="va">True</span>,inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>df1_2.reset_index(drop<span class="op">=</span><span class="va">True</span>,inplace<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
</div>
<div class="cell markdown" id="9nyL7AOm_SeU">
<p>###<strong>EDA2 (IMDB) - Audience perception &amp; rating behavior
analysis (DataFrame2 Cleaning)</strong></p>
</div>
<div class="cell code" data-execution_count="172"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="ixlosrpQ2Wnh" data-outputId="88f5cb8b-5109-4a54-89d5-1de3a142f1ee">
<div class="sourceCode" id="cb39"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>df2.info()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Index: 859618 entries, 0 to 1116351
Data columns (total 13 columns):
 #   Column                Non-Null Count   Dtype  
---  ------                --------------   -----  
 0   title                 859613 non-null  object 
 1   status                859618 non-null  object 
 2   release_date          801023 non-null  object 
 3   runtime               859618 non-null  float64
 4   original_language     859618 non-null  object 
 5   genres                659761 non-null  object 
 6   production_companies  442795 non-null  object 
 7   production_countries  571574 non-null  object 
 8   cast                  610706 non-null  object 
 9   director              765230 non-null  object 
 10  writers               471886 non-null  object 
 11  imdb_rating           410119 non-null  float64
 12  imdb_votes            410119 non-null  float64
dtypes: float64(3), object(10)
memory usage: 91.8+ MB
</code></pre>
</div>
</div>
<div class="cell markdown" id="b2qMLwmyJuL_">
<p>We will investigate how diffrent columns affect the overall rows drop
count. The columns <strong><code>title</code>, <code>status</code>,
<code>release_date</code>, <code>runtime</code>,
<code>original_language</code>, <code>imdb_rating</code>,
<code>imdb_votes</code></strong> must be included at all costs at the
final Dataframe.</p>
</div>
<div class="cell code" data-execution_count="173"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="u9pC-djlAgId" data-outputId="db4dc159-1895-4e6e-b4ff-7671cbcd26b8">
<div class="sourceCode" id="cb41"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating a list with the columns to be investigated</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>C <span class="op">=</span>[<span class="st">&#39;production_companies&#39;</span>,<span class="st">&#39;production_countries&#39;</span>,<span class="st">&#39;cast&#39;</span>,<span class="st">&#39;director&#39;</span>,<span class="st">&#39;writers&#39;</span>]</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> C:</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="ss">f&#39;The length of Dataframe by dropping column </span><span class="sc">{</span>i<span class="sc">}</span><span class="ss"> is </span><span class="sc">{</span><span class="bu">len</span>(df2.dropna(subset<span class="op">=</span>[<span class="st">&#39;title&#39;</span>,<span class="st">&#39;status&#39;</span>,<span class="st">&#39;release_date&#39;</span>,<span class="st">&#39;runtime&#39;</span>,<span class="st">&#39;original_language&#39;</span>,<span class="st">&#39;genres&#39;</span>,<span class="st">&#39;imdb_rating&#39;</span>,<span class="st">&#39;imdb_votes&#39;</span>,i]))<span class="sc">}</span><span class="ss">&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>The length of Dataframe by dropping column production_companies is 270648
The length of Dataframe by dropping column production_countries is 317958
The length of Dataframe by dropping column cast is 330511
The length of Dataframe by dropping column director is 357661
The length of Dataframe by dropping column writers is 285583
</code></pre>
</div>
</div>
<div class="cell markdown" id="B6Jx2CGbVSNs">
<p><code>Production Companies</code> and <code>Writers</code> columns
are causing the most loss. So we will completely drop them. Dropping
theese 2 columns are saving up to 80k rows!</p>
</div>
<div class="cell code" data-execution_count="174" id="UvZPShdmUTp9">
<div class="sourceCode" id="cb43"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Dropping Columns</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>df2.drop(columns<span class="op">=</span>[<span class="st">&#39;production_companies&#39;</span>,<span class="st">&#39;writers&#39;</span>],inplace<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="175" id="FbGPubqnApAF">
<div class="sourceCode" id="cb44"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Dropping NA&#39;s</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>df2.dropna(inplace<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
</div>
<div class="cell markdown" id="2jfLzxA2Wihz">
<p>Now as above we will perform a duplication test, and eliminate the
duplicates. As we will see we don't have any and we will proceed with
index reset.</p>
</div>
<div class="cell code" data-execution_count="176"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="QkgXdjDrV7lV" data-outputId="9d1788d3-ddaf-4a4a-b3e8-ce4a66878c83">
<div class="sourceCode" id="cb45"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Duplicates Check</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>df2.duplicated().<span class="bu">sum</span>()</span></code></pre></div>
<div class="output execute_result" data-execution_count="176">
<pre><code>np.int64(0)</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="177" id="b-D2pzEzWZ9N">
<div class="sourceCode" id="cb47"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Reset Index</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>df2.reset_index(drop<span class="op">=</span><span class="va">True</span>,inplace<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
</div>
<div class="cell markdown" id="7BEJWQeLX602">
<p>##<strong>Step 4: Feature Engineering</strong> In this step, we will
create additional features to enhance the analysis. Since the raw
dataset contains mostly descriptive information, our goal is to extract
useful numerical and categorical insights from existing columns.</p>
<ul>
<li><p>Genre simplification → Keep only the first listed genre (main
genre) to reduce categorical noise.</p></li>
<li><p>Rating bins → Create rating categories such as:</p>
<p>0–4.9 → Poor</p>
<p>5.0–6.9 → Average</p>
<p>7.0–8.4 → Good</p>
<p>8.5–10.0 → Excellent</p>
<p>This helps visualize the distribution of movie quality.</p></li>
<li><p>Runtime bins, categorize movies as:</p>
<p>→ Short (&lt;80 min)</p>
<p>→ Standard (80–120 min)</p>
<p>→ Long (&gt;120 min)</p></li>
<li><p>Decade</p></li>
<li><p>Movie Profit</p></li>
<li><p>ROI (Return on Investment)</p></li>
</ul>
</div>
<div class="cell markdown" id="x_veoHy4iNKE">
<p><strong>For General Analysis (df1_1)</strong></p>
</div>
<div class="cell code" data-execution_count="178" id="0A5_GCvRbwxl">
<div class="sourceCode" id="cb48"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Genre Simplification</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>df1_1[<span class="st">&#39;genres_simplified&#39;</span>] <span class="op">=</span> df1_1[<span class="st">&#39;genres&#39;</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: x.split(<span class="st">&#39;,&#39;</span>)[<span class="dv">0</span>])</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="179" id="WY0Lrtlgbw0G">
<div class="sourceCode" id="cb49"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Rating Bins (from Vote Average)</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>bins <span class="op">=</span> [<span class="dv">0</span>,<span class="fl">4.9</span>,<span class="fl">6.9</span>,<span class="fl">8.4</span>,<span class="dv">10</span>]</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> [<span class="st">&#39;Poor&#39;</span>,<span class="st">&#39;Average&#39;</span>,<span class="st">&#39;Good&#39;</span>,<span class="st">&#39;Excellent&#39;</span>]</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>df1_1[<span class="st">&#39;rating_bins&#39;</span>] <span class="op">=</span> pd.cut(df1_1[<span class="st">&#39;vote_average&#39;</span>], bins<span class="op">=</span>bins, labels<span class="op">=</span>labels)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="180" id="go88bKRgedbF">
<div class="sourceCode" id="cb50"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Runtime Bins</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>bins1 <span class="op">=</span> [<span class="dv">0</span>,<span class="dv">80</span>,<span class="dv">120</span>,np.inf]</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>labels1 <span class="op">=</span> [<span class="st">&#39;Short&#39;</span>,<span class="st">&#39;Standard&#39;</span>,<span class="st">&#39;Long&#39;</span>]</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>df1_1[<span class="st">&#39;runtime_bins&#39;</span>] <span class="op">=</span> pd.cut(df1_1[<span class="st">&#39;runtime&#39;</span>], bins<span class="op">=</span>bins1, labels<span class="op">=</span>labels1)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="181" id="xlscJaeyedS3">
<div class="sourceCode" id="cb51"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Decade</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>df1_1[<span class="st">&#39;decade&#39;</span>] <span class="op">=</span> df1_1[<span class="st">&#39;release_date&#39;</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: x[<span class="dv">0</span>:<span class="dv">3</span>]<span class="op">+</span><span class="st">&#39;0s&#39;</span>)</span></code></pre></div>
</div>
<div class="cell markdown" id="O7ZlXg7_iZDq">
<p><strong>For Economic Anlysis (df1_2)</strong></p>
</div>
<div class="cell code" data-execution_count="182"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="NKB_kme4cpZA" data-outputId="1011592d-0097-4d92-c52e-8b00ee26a9ae">
<div class="sourceCode" id="cb52"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Decade</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>df1_2[<span class="st">&#39;decade&#39;</span>] <span class="op">=</span> df1_2[<span class="st">&#39;release_date&#39;</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: x[<span class="dv">0</span>:<span class="dv">3</span>]<span class="op">+</span><span class="st">&#39;0s&#39;</span>)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/tmp/ipython-input-1967503570.py:2: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df1_2[&#39;decade&#39;] = df1_2[&#39;release_date&#39;].apply(lambda x: x[0:3]+&#39;0s&#39;)
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="183"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="2n57rsd7bw2v" data-outputId="2784f570-3c6e-40d0-f3c4-7d5659ed24f6">
<div class="sourceCode" id="cb54"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Movie Profit</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>df1_2[<span class="st">&#39;profit&#39;</span>] <span class="op">=</span> df1_2[<span class="st">&#39;revenue&#39;</span>] <span class="op">-</span> df1_2[<span class="st">&#39;budget&#39;</span>]</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/tmp/ipython-input-730984816.py:2: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df1_2[&#39;profit&#39;] = df1_2[&#39;revenue&#39;] - df1_2[&#39;budget&#39;]
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="184"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="mPwKVA7OjDkl" data-outputId="54db7b4d-93a8-43aa-f17c-7113783974ec">
<div class="sourceCode" id="cb56"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ROI (Return on Investment)</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>df1_2[<span class="st">&#39;roi&#39;</span>] <span class="op">=</span> (df1_2[<span class="st">&#39;revenue&#39;</span>] <span class="op">-</span> df1_2[<span class="st">&#39;budget&#39;</span>]) <span class="op">/</span> df1_2[<span class="st">&#39;budget&#39;</span>]</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>df1_2 <span class="op">=</span> df1_2[df1_2[<span class="st">&#39;roi&#39;</span>].between(<span class="op">-</span><span class="dv">1</span>, <span class="dv">10</span>)].reset_index()</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/tmp/ipython-input-1293334189.py:2: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df1_2[&#39;roi&#39;] = (df1_2[&#39;revenue&#39;] - df1_2[&#39;budget&#39;]) / df1_2[&#39;budget&#39;]
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="185" id="hoLu8_VokKto">
<div class="sourceCode" id="cb58"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Genre Simplification</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>df1_2[<span class="st">&#39;genres_simplified&#39;</span>]<span class="op">=</span>df1_2[<span class="st">&#39;genres&#39;</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: x.split(<span class="st">&#39;,&#39;</span>)[<span class="dv">0</span>])</span></code></pre></div>
</div>
<div class="cell markdown" id="KA9RdmZYkw3v">
<p><strong>For IMDB Ratings (df2)</strong></p>
</div>
<div class="cell code" data-execution_count="186" id="9XGRP6gfkKwn">
<div class="sourceCode" id="cb59"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Release Year + Relase Decade</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>df2[<span class="st">&#39;release_year&#39;</span>] <span class="op">=</span> df2[<span class="st">&#39;release_date&#39;</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: x[<span class="dv">0</span>:<span class="dv">4</span>])</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>df2[<span class="st">&#39;decade&#39;</span>] <span class="op">=</span> df2[<span class="st">&#39;release_date&#39;</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: x[<span class="dv">0</span>:<span class="dv">3</span>]<span class="op">+</span><span class="st">&#39;0s&#39;</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="187" id="jUhBbVzXrR0t">
<div class="sourceCode" id="cb60"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co">#IMDB Rating</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>bins2 <span class="op">=</span> [<span class="dv">0</span>,<span class="fl">4.9</span>,<span class="fl">6.9</span>,<span class="fl">8.4</span>,<span class="dv">10</span>]</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>labels2 <span class="op">=</span> [<span class="st">&#39;Poor&#39;</span>,<span class="st">&#39;Average&#39;</span>,<span class="st">&#39;Good&#39;</span>,<span class="st">&#39;Excellent&#39;</span>]</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>df2[<span class="st">&#39;rating_bins&#39;</span>] <span class="op">=</span> pd.cut(df2[<span class="st">&#39;imdb_rating&#39;</span>], bins<span class="op">=</span>bins2, labels<span class="op">=</span>labels2)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="188" id="T4yPq-MvrRcl">
<div class="sourceCode" id="cb61"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Main Genre</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>df2[<span class="st">&#39;genres_simplified&#39;</span>] <span class="op">=</span> df2[<span class="st">&#39;genres&#39;</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: x.split(<span class="st">&#39;,&#39;</span>)[<span class="dv">0</span>])</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="189" id="R_vrTl8isA-4">
<div class="sourceCode" id="cb62"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Number of Actors</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>df2[<span class="st">&#39;cast_count&#39;</span>] <span class="op">=</span> df2[<span class="st">&#39;cast&#39;</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="bu">len</span>(x.split(<span class="st">&#39;,&#39;</span>)))</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="190" id="K4LdGxY3sn5C">
<div class="sourceCode" id="cb63"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Runtime Bins</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>df2[<span class="st">&#39;runtime_bins&#39;</span>] <span class="op">=</span> pd.cut(df2[<span class="st">&#39;runtime&#39;</span>], bins<span class="op">=</span>bins1, labels<span class="op">=</span>labels1)</span></code></pre></div>
</div>
<div class="cell markdown" id="BicTEFq9vIXa">
<p>##<strong>Step 5: Statistical Analysis (Descriptive)</strong> At this
step we will perform Statistical Analysis. We will:</p>
<ul>
<li>Filter Outliers For Economical Analysis</li>
<li>Perform Group Analysis</li>
</ul>
</div>
<div class="cell markdown" id="PA49-C4PfCmA">
<p>###<strong>Outlier Filtering for Economical Analysis</strong></p>
</div>
<div class="cell markdown" id="NuWxTuN2qiQK">
<p>The goal here is to filter the budget and revenue as earlier movies
might have estimations and not real values and this can affect roi. We
will keep all observations (movies) within 2 standard deviations. This
will secure us approximately 95.4% of observations and outliers will be
removed.</p>
</div>
<div class="cell code" data-execution_count="191"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:0}"
id="YwrHCo4ZfYOU" data-outputId="d0193cfd-9499-455b-daaf-3b15f89a60fe">
<div class="sourceCode" id="cb64"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Reviewing the Dataframe</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>df1_2.drop(columns<span class="op">=</span>[<span class="st">&#39;index&#39;</span>], inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>df1_2.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="191">

  <div id="df-4b43acb0-2440-47c4-8140-88449c6c4658" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>title</th>
      <th>vote_average</th>
      <th>vote_count</th>
      <th>status</th>
      <th>release_date</th>
      <th>revenue</th>
      <th>runtime</th>
      <th>budget</th>
      <th>original_language</th>
      <th>popularity</th>
      <th>genres</th>
      <th>decade</th>
      <th>profit</th>
      <th>roi</th>
      <th>genres_simplified</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Four Rooms</td>
      <td>5.869</td>
      <td>2736.0</td>
      <td>Released</td>
      <td>1995-12-09</td>
      <td>4257354.0</td>
      <td>98.0</td>
      <td>4000000.0</td>
      <td>en</td>
      <td>3.4949</td>
      <td>Comedy</td>
      <td>1990s</td>
      <td>257354.0</td>
      <td>0.064339</td>
      <td>Comedy</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Judgment Night</td>
      <td>6.500</td>
      <td>360.0</td>
      <td>Released</td>
      <td>1993-10-15</td>
      <td>12136938.0</td>
      <td>109.0</td>
      <td>21000000.0</td>
      <td>en</td>
      <td>4.2730</td>
      <td>Action, Crime, Thriller</td>
      <td>1990s</td>
      <td>-8863062.0</td>
      <td>-0.422051</td>
      <td>Action</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Finding Nemo</td>
      <td>7.817</td>
      <td>19955.0</td>
      <td>Released</td>
      <td>2003-05-30</td>
      <td>940335536.0</td>
      <td>100.0</td>
      <td>94000000.0</td>
      <td>en</td>
      <td>13.9930</td>
      <td>Animation, Family</td>
      <td>2000s</td>
      <td>846335536.0</td>
      <td>9.003570</td>
      <td>Animation</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Dancer in the Dark</td>
      <td>7.865</td>
      <td>1891.0</td>
      <td>Released</td>
      <td>2000-09-01</td>
      <td>40061153.0</td>
      <td>140.0</td>
      <td>12500000.0</td>
      <td>en</td>
      <td>4.7205</td>
      <td>Drama, Crime</td>
      <td>2000s</td>
      <td>27561153.0</td>
      <td>2.204892</td>
      <td>Drama</td>
    </tr>
    <tr>
      <th>4</th>
      <td>The Fifth Element</td>
      <td>7.560</td>
      <td>11240.0</td>
      <td>Released</td>
      <td>1997-05-02</td>
      <td>263920180.0</td>
      <td>126.0</td>
      <td>90000000.0</td>
      <td>fr</td>
      <td>11.0271</td>
      <td>Science Fiction, Action, Adventure</td>
      <td>1990s</td>
      <td>173920180.0</td>
      <td>1.932446</td>
      <td>Science Fiction</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-4b43acb0-2440-47c4-8140-88449c6c4658')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-4b43acb0-2440-47c4-8140-88449c6c4658 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-4b43acb0-2440-47c4-8140-88449c6c4658');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-10b8103e-de54-4ade-87ad-26b98faa7426">
      <button class="colab-df-quickchart" onclick="quickchart('df-10b8103e-de54-4ade-87ad-26b98faa7426')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-10b8103e-de54-4ade-87ad-26b98faa7426 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="192" id="2CSNuQuYfYXV">
<div class="sourceCode" id="cb65"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Defining Means and Std&#39;s for Budget and Revenue</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>budget_mean <span class="op">=</span> df1_2[<span class="st">&#39;budget&#39;</span>].mean()</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>budget_std <span class="op">=</span> df1_2[<span class="st">&#39;budget&#39;</span>].std()</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>revenue_mean <span class="op">=</span> df1_2[<span class="st">&#39;revenue&#39;</span>].mean()</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>revenue_std <span class="op">=</span> df1_2[<span class="st">&#39;revenue&#39;</span>].std()</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="193" id="cZg-27mcfltS">
<div class="sourceCode" id="cb66"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Filtering by keeping values up to 2 standard deviations</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>df1_2_filtered <span class="op">=</span> (df1_2[(df1_2[<span class="st">&#39;budget&#39;</span>]</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>                         .between(budget_mean <span class="op">-</span> <span class="dv">2</span><span class="op">*</span>budget_std,</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>                                  budget_mean <span class="op">+</span> <span class="dv">2</span><span class="op">*</span>budget_std)</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>                         <span class="op">&amp;</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>                  df1_2[<span class="st">&#39;revenue&#39;</span>]</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>                         .between(revenue_mean <span class="op">-</span> <span class="dv">2</span><span class="op">*</span>revenue_std,</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>                                  revenue_mean <span class="op">+</span> <span class="dv">2</span><span class="op">*</span>revenue_std))])</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>df1_2_filtered.reset_index(drop<span class="op">=</span><span class="va">True</span>,inplace<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
</div>
<div class="cell markdown" id="YBDgeK3iA8c1">
<p>###<strong>Group Analysis</strong></p>
</div>
<div class="cell markdown" id="6Ltb4o87CUct">
<p>####<strong>General Analysis</strong></p>
</div>
<div class="cell code" data-execution_count="194"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:206}"
id="OuCmIUaywXDJ" data-outputId="089af728-db22-4f82-a3e7-0a5c309e490b">
<div class="sourceCode" id="cb67"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>df1_1.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="194">

  <div id="df-47b184d8-bfb9-4367-9fa9-8ab21a598da1" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>title</th>
      <th>vote_average</th>
      <th>vote_count</th>
      <th>status</th>
      <th>release_date</th>
      <th>runtime</th>
      <th>original_language</th>
      <th>popularity</th>
      <th>genres</th>
      <th>genres_simplified</th>
      <th>rating_bins</th>
      <th>runtime_bins</th>
      <th>decade</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Ariel</td>
      <td>7.100</td>
      <td>356.0</td>
      <td>Released</td>
      <td>1988-10-21</td>
      <td>73.0</td>
      <td>fi</td>
      <td>2.5366</td>
      <td>Comedy, Drama, Romance, Crime</td>
      <td>Comedy</td>
      <td>Good</td>
      <td>Short</td>
      <td>1980s</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Shadows in Paradise</td>
      <td>7.290</td>
      <td>416.0</td>
      <td>Released</td>
      <td>1986-10-17</td>
      <td>74.0</td>
      <td>fi</td>
      <td>0.8067</td>
      <td>Comedy, Drama, Romance</td>
      <td>Comedy</td>
      <td>Good</td>
      <td>Short</td>
      <td>1980s</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Four Rooms</td>
      <td>5.869</td>
      <td>2736.0</td>
      <td>Released</td>
      <td>1995-12-09</td>
      <td>98.0</td>
      <td>en</td>
      <td>3.4949</td>
      <td>Comedy</td>
      <td>Comedy</td>
      <td>Average</td>
      <td>Standard</td>
      <td>1990s</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Judgment Night</td>
      <td>6.500</td>
      <td>360.0</td>
      <td>Released</td>
      <td>1993-10-15</td>
      <td>109.0</td>
      <td>en</td>
      <td>4.2730</td>
      <td>Action, Crime, Thriller</td>
      <td>Action</td>
      <td>Average</td>
      <td>Standard</td>
      <td>1990s</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Life in Loops (A Megacities RMX)</td>
      <td>7.500</td>
      <td>27.0</td>
      <td>Released</td>
      <td>2006-01-01</td>
      <td>80.0</td>
      <td>en</td>
      <td>3.2030</td>
      <td>Documentary</td>
      <td>Documentary</td>
      <td>Good</td>
      <td>Short</td>
      <td>2000s</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-47b184d8-bfb9-4367-9fa9-8ab21a598da1')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-47b184d8-bfb9-4367-9fa9-8ab21a598da1 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-47b184d8-bfb9-4367-9fa9-8ab21a598da1');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-8a2ce33f-31e0-4723-be26-42d2e1d7b1a9">
      <button class="colab-df-quickchart" onclick="quickchart('df-8a2ce33f-31e0-4723-be26-42d2e1d7b1a9')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-8a2ce33f-31e0-4723-be26-42d2e1d7b1a9 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="195"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:582}"
id="2mePap0WwPAE" data-outputId="4deaaf33-49fd-46a8-aa4a-26194f0fd8d3">
<div class="sourceCode" id="cb68"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Number of Movies per Decade</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>movies_per_decade <span class="op">=</span> df1_1.groupby(<span class="st">&#39;decade&#39;</span>).size().reset_index(name<span class="op">=</span><span class="st">&#39;count&#39;</span>)</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>movies_per_decade</span></code></pre></div>
<div class="output execute_result" data-execution_count="195">

  <div id="df-c737fded-a723-4883-8351-cff865c21228" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>decade</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1870s</td>
      <td>6</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1880s</td>
      <td>7</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1890s</td>
      <td>1189</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1900s</td>
      <td>3008</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1910s</td>
      <td>8836</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1920s</td>
      <td>9708</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1930s</td>
      <td>15024</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1940s</td>
      <td>14014</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1950s</td>
      <td>18343</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1960s</td>
      <td>25804</td>
    </tr>
    <tr>
      <th>10</th>
      <td>1970s</td>
      <td>33309</td>
    </tr>
    <tr>
      <th>11</th>
      <td>1980s</td>
      <td>40080</td>
    </tr>
    <tr>
      <th>12</th>
      <td>1990s</td>
      <td>48312</td>
    </tr>
    <tr>
      <th>13</th>
      <td>2000s</td>
      <td>84030</td>
    </tr>
    <tr>
      <th>14</th>
      <td>2010s</td>
      <td>172440</td>
    </tr>
    <tr>
      <th>15</th>
      <td>2020s</td>
      <td>165210</td>
    </tr>
    <tr>
      <th>16</th>
      <td>2030s</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-c737fded-a723-4883-8351-cff865c21228')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-c737fded-a723-4883-8351-cff865c21228 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-c737fded-a723-4883-8351-cff865c21228');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-edb38aab-1b80-4768-bf00-167a89e15163">
      <button class="colab-df-quickchart" onclick="quickchart('df-edb38aab-1b80-4768-bf00-167a89e15163')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-edb38aab-1b80-4768-bf00-167a89e15163 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_209a099f-d4e8-4fe9-8127-baf732b4014b">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('movies_per_decade')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_209a099f-d4e8-4fe9-8127-baf732b4014b button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('movies_per_decade');
      }
      })();
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="196"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:1000}"
id="fTmD6lgW5k5i" data-outputId="6e143ce6-0248-4123-cf81-3419e258e1d2">
<div class="sourceCode" id="cb69"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Top 3 Genres Per Decade (Movies Recorded)</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>top_genres <span class="op">=</span> (df1_1</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>              .groupby([<span class="st">&#39;decade&#39;</span>,<span class="st">&#39;genres_simplified&#39;</span>])</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>              .size().reset_index(name<span class="op">=</span><span class="st">&#39;count&#39;</span>)</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>              .sort_values(by<span class="op">=</span>[<span class="st">&#39;decade&#39;</span>,<span class="st">&#39;count&#39;</span>], ascending<span class="op">=</span>[<span class="va">True</span>,<span class="va">False</span>])</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>              .groupby(<span class="st">&#39;decade&#39;</span>).head(<span class="dv">3</span>).reset_index(drop<span class="op">=</span><span class="va">True</span>))</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>top_genres</span></code></pre></div>
<div class="output execute_result" data-execution_count="196">

  <div id="df-aef43c81-0c49-481d-8331-99d769cf2930" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>decade</th>
      <th>genres_simplified</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1870s</td>
      <td>Animation</td>
      <td>5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1870s</td>
      <td>Documentary</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1880s</td>
      <td>Documentary</td>
      <td>7</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1890s</td>
      <td>Documentary</td>
      <td>911</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1890s</td>
      <td>Comedy</td>
      <td>137</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1890s</td>
      <td>Drama</td>
      <td>46</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1900s</td>
      <td>Documentary</td>
      <td>1266</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1900s</td>
      <td>Comedy</td>
      <td>761</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1900s</td>
      <td>Drama</td>
      <td>427</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1910s</td>
      <td>Drama</td>
      <td>3522</td>
    </tr>
    <tr>
      <th>10</th>
      <td>1910s</td>
      <td>Comedy</td>
      <td>2505</td>
    </tr>
    <tr>
      <th>11</th>
      <td>1910s</td>
      <td>Western</td>
      <td>679</td>
    </tr>
    <tr>
      <th>12</th>
      <td>1920s</td>
      <td>Drama</td>
      <td>2998</td>
    </tr>
    <tr>
      <th>13</th>
      <td>1920s</td>
      <td>Comedy</td>
      <td>2541</td>
    </tr>
    <tr>
      <th>14</th>
      <td>1920s</td>
      <td>Animation</td>
      <td>928</td>
    </tr>
    <tr>
      <th>15</th>
      <td>1930s</td>
      <td>Comedy</td>
      <td>4018</td>
    </tr>
    <tr>
      <th>16</th>
      <td>1930s</td>
      <td>Drama</td>
      <td>3295</td>
    </tr>
    <tr>
      <th>17</th>
      <td>1930s</td>
      <td>Animation</td>
      <td>1970</td>
    </tr>
    <tr>
      <th>18</th>
      <td>1940s</td>
      <td>Drama</td>
      <td>3032</td>
    </tr>
    <tr>
      <th>19</th>
      <td>1940s</td>
      <td>Comedy</td>
      <td>2803</td>
    </tr>
    <tr>
      <th>20</th>
      <td>1940s</td>
      <td>Documentary</td>
      <td>2152</td>
    </tr>
    <tr>
      <th>21</th>
      <td>1950s</td>
      <td>Drama</td>
      <td>5066</td>
    </tr>
    <tr>
      <th>22</th>
      <td>1950s</td>
      <td>Comedy</td>
      <td>3282</td>
    </tr>
    <tr>
      <th>23</th>
      <td>1950s</td>
      <td>Documentary</td>
      <td>2742</td>
    </tr>
    <tr>
      <th>24</th>
      <td>1960s</td>
      <td>Drama</td>
      <td>7045</td>
    </tr>
    <tr>
      <th>25</th>
      <td>1960s</td>
      <td>Documentary</td>
      <td>4626</td>
    </tr>
    <tr>
      <th>26</th>
      <td>1960s</td>
      <td>Comedy</td>
      <td>3995</td>
    </tr>
    <tr>
      <th>27</th>
      <td>1970s</td>
      <td>Drama</td>
      <td>9201</td>
    </tr>
    <tr>
      <th>28</th>
      <td>1970s</td>
      <td>Documentary</td>
      <td>6043</td>
    </tr>
    <tr>
      <th>29</th>
      <td>1970s</td>
      <td>Comedy</td>
      <td>4614</td>
    </tr>
    <tr>
      <th>30</th>
      <td>1980s</td>
      <td>Drama</td>
      <td>11069</td>
    </tr>
    <tr>
      <th>31</th>
      <td>1980s</td>
      <td>Documentary</td>
      <td>6717</td>
    </tr>
    <tr>
      <th>32</th>
      <td>1980s</td>
      <td>Comedy</td>
      <td>5649</td>
    </tr>
    <tr>
      <th>33</th>
      <td>1990s</td>
      <td>Drama</td>
      <td>11279</td>
    </tr>
    <tr>
      <th>34</th>
      <td>1990s</td>
      <td>Documentary</td>
      <td>9982</td>
    </tr>
    <tr>
      <th>35</th>
      <td>1990s</td>
      <td>Comedy</td>
      <td>6638</td>
    </tr>
    <tr>
      <th>36</th>
      <td>2000s</td>
      <td>Documentary</td>
      <td>22183</td>
    </tr>
    <tr>
      <th>37</th>
      <td>2000s</td>
      <td>Drama</td>
      <td>18063</td>
    </tr>
    <tr>
      <th>38</th>
      <td>2000s</td>
      <td>Comedy</td>
      <td>11431</td>
    </tr>
    <tr>
      <th>39</th>
      <td>2010s</td>
      <td>Documentary</td>
      <td>46662</td>
    </tr>
    <tr>
      <th>40</th>
      <td>2010s</td>
      <td>Drama</td>
      <td>40610</td>
    </tr>
    <tr>
      <th>41</th>
      <td>2010s</td>
      <td>Comedy</td>
      <td>21838</td>
    </tr>
    <tr>
      <th>42</th>
      <td>2020s</td>
      <td>Documentary</td>
      <td>43716</td>
    </tr>
    <tr>
      <th>43</th>
      <td>2020s</td>
      <td>Drama</td>
      <td>41216</td>
    </tr>
    <tr>
      <th>44</th>
      <td>2020s</td>
      <td>Comedy</td>
      <td>18897</td>
    </tr>
    <tr>
      <th>45</th>
      <td>2030s</td>
      <td>Drama</td>
      <td>1</td>
    </tr>
    <tr>
      <th>46</th>
      <td>2030s</td>
      <td>Horror</td>
      <td>1</td>
    </tr>
    <tr>
      <th>47</th>
      <td>2030s</td>
      <td>Science Fiction</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-aef43c81-0c49-481d-8331-99d769cf2930')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-aef43c81-0c49-481d-8331-99d769cf2930 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-aef43c81-0c49-481d-8331-99d769cf2930');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-e9d7e110-6926-4eb0-a9b5-c1516eb8b07a">
      <button class="colab-df-quickchart" onclick="quickchart('df-e9d7e110-6926-4eb0-a9b5-c1516eb8b07a')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-e9d7e110-6926-4eb0-a9b5-c1516eb8b07a button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_2329f378-de24-4d9f-a193-6a21aa0814e0">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('top_genres')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_2329f378-de24-4d9f-a193-6a21aa0814e0 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('top_genres');
      }
      })();
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="197"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:614}"
id="iEQ5XEpN5k_P" data-outputId="2709c411-9b45-4451-feba-30a4ab0a4421">
<div class="sourceCode" id="cb70"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Median Time</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>median_time <span class="op">=</span> df1_1.groupby([<span class="st">&#39;decade&#39;</span>])[<span class="st">&#39;runtime&#39;</span>].median()</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>median_time <span class="op">=</span> pd.DataFrame(median_time)</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>median_time</span></code></pre></div>
<div class="output execute_result" data-execution_count="197">

  <div id="df-0a7bc84c-1dd6-4476-8fd2-e79204ac51e7" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>runtime</th>
    </tr>
    <tr>
      <th>decade</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1870s</th>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1880s</th>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1890s</th>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1900s</th>
      <td>3.0</td>
    </tr>
    <tr>
      <th>1910s</th>
      <td>20.0</td>
    </tr>
    <tr>
      <th>1920s</th>
      <td>55.0</td>
    </tr>
    <tr>
      <th>1930s</th>
      <td>65.0</td>
    </tr>
    <tr>
      <th>1940s</th>
      <td>66.0</td>
    </tr>
    <tr>
      <th>1950s</th>
      <td>82.0</td>
    </tr>
    <tr>
      <th>1960s</th>
      <td>83.0</td>
    </tr>
    <tr>
      <th>1970s</th>
      <td>85.0</td>
    </tr>
    <tr>
      <th>1980s</th>
      <td>86.0</td>
    </tr>
    <tr>
      <th>1990s</th>
      <td>86.0</td>
    </tr>
    <tr>
      <th>2000s</th>
      <td>83.0</td>
    </tr>
    <tr>
      <th>2010s</th>
      <td>71.0</td>
    </tr>
    <tr>
      <th>2020s</th>
      <td>38.0</td>
    </tr>
    <tr>
      <th>2030s</th>
      <td>129.0</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-0a7bc84c-1dd6-4476-8fd2-e79204ac51e7')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-0a7bc84c-1dd6-4476-8fd2-e79204ac51e7 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-0a7bc84c-1dd6-4476-8fd2-e79204ac51e7');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-8d3d1b11-2f4f-406c-b60e-20565e46a057">
      <button class="colab-df-quickchart" onclick="quickchart('df-8d3d1b11-2f4f-406c-b60e-20565e46a057')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-8d3d1b11-2f4f-406c-b60e-20565e46a057 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_b27fc574-def2-4663-aaa9-95a578dafa8c">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('median_time')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_b27fc574-def2-4663-aaa9-95a578dafa8c button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('median_time');
      }
      })();
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="198"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:637}"
id="Ait5ru6pGc1m" data-outputId="ae529a9c-906e-4152-8194-0214f9af1971">
<div class="sourceCode" id="cb71"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Runtime bins per Decade</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>runtime_bins <span class="op">=</span> (df1_1</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>                .groupby([<span class="st">&#39;decade&#39;</span>,<span class="st">&#39;runtime_bins&#39;</span>])</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>                .size().reset_index(name<span class="op">=</span><span class="st">&#39;count&#39;</span>)</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>                .sort_values(by<span class="op">=</span>[<span class="st">&#39;decade&#39;</span>,<span class="st">&#39;count&#39;</span>], ascending<span class="op">=</span>[<span class="va">True</span>,<span class="va">False</span>])</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>                .groupby(<span class="st">&#39;decade&#39;</span>).head(<span class="dv">1</span>))</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>runtime_bins</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/tmp/ipython-input-1705825376.py:3: FutureWarning: The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.
  .groupby([&#39;decade&#39;,&#39;runtime_bins&#39;])
</code></pre>
</div>
<div class="output execute_result" data-execution_count="198">

  <div id="df-441375c4-8f64-41c2-8851-8a17ef851b8e" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>decade</th>
      <th>runtime_bins</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1870s</td>
      <td>Short</td>
      <td>6</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1880s</td>
      <td>Short</td>
      <td>7</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1890s</td>
      <td>Short</td>
      <td>1187</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1900s</td>
      <td>Short</td>
      <td>3004</td>
    </tr>
    <tr>
      <th>12</th>
      <td>1910s</td>
      <td>Short</td>
      <td>8480</td>
    </tr>
    <tr>
      <th>15</th>
      <td>1920s</td>
      <td>Short</td>
      <td>8159</td>
    </tr>
    <tr>
      <th>18</th>
      <td>1930s</td>
      <td>Short</td>
      <td>11212</td>
    </tr>
    <tr>
      <th>21</th>
      <td>1940s</td>
      <td>Short</td>
      <td>8968</td>
    </tr>
    <tr>
      <th>24</th>
      <td>1950s</td>
      <td>Short</td>
      <td>8796</td>
    </tr>
    <tr>
      <th>28</th>
      <td>1960s</td>
      <td>Standard</td>
      <td>12226</td>
    </tr>
    <tr>
      <th>31</th>
      <td>1970s</td>
      <td>Standard</td>
      <td>15888</td>
    </tr>
    <tr>
      <th>34</th>
      <td>1980s</td>
      <td>Standard</td>
      <td>19123</td>
    </tr>
    <tr>
      <th>37</th>
      <td>1990s</td>
      <td>Standard</td>
      <td>22827</td>
    </tr>
    <tr>
      <th>39</th>
      <td>2000s</td>
      <td>Short</td>
      <td>40086</td>
    </tr>
    <tr>
      <th>42</th>
      <td>2010s</td>
      <td>Short</td>
      <td>98943</td>
    </tr>
    <tr>
      <th>45</th>
      <td>2020s</td>
      <td>Short</td>
      <td>112266</td>
    </tr>
    <tr>
      <th>50</th>
      <td>2030s</td>
      <td>Long</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-441375c4-8f64-41c2-8851-8a17ef851b8e')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-441375c4-8f64-41c2-8851-8a17ef851b8e button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-441375c4-8f64-41c2-8851-8a17ef851b8e');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-2aaf83c1-b1d7-45e4-9bdd-ed77c317d4a5">
      <button class="colab-df-quickchart" onclick="quickchart('df-2aaf83c1-b1d7-45e4-9bdd-ed77c317d4a5')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-2aaf83c1-b1d7-45e4-9bdd-ed77c317d4a5 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_92918dd4-2e56-4859-8766-0884a9ccdba0">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('runtime_bins')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_92918dd4-2e56-4859-8766-0884a9ccdba0 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('runtime_bins');
      }
      })();
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="199"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:1000}"
id="mp_wWQlgDGOA" data-outputId="21833d13-a4dd-4ebc-f367-f4af7d284d1d">
<div class="sourceCode" id="cb73"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Ratings per Decade</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>ratings_decade <span class="op">=</span> (df1_1</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>                  .groupby([<span class="st">&#39;decade&#39;</span>,<span class="st">&#39;rating_bins&#39;</span>])</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>                  .size().reset_index(name<span class="op">=</span><span class="st">&#39;count&#39;</span>)</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>                  .sort_values(by<span class="op">=</span>[<span class="st">&#39;decade&#39;</span>,<span class="st">&#39;count&#39;</span>], ascending<span class="op">=</span>[<span class="va">True</span>,<span class="va">False</span>])</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>                  .groupby(<span class="st">&#39;decade&#39;</span>).head(<span class="dv">3</span>))</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>ratings_decade</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/tmp/ipython-input-3992899315.py:3: FutureWarning: The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.
  .groupby([&#39;decade&#39;,&#39;rating_bins&#39;])
</code></pre>
</div>
<div class="output execute_result" data-execution_count="199">

  <div id="df-33069d81-a082-46f7-bf95-90bcb9deeffb" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>decade</th>
      <th>rating_bins</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>1870s</td>
      <td>Average</td>
      <td>2</td>
    </tr>
    <tr>
      <th>0</th>
      <td>1870s</td>
      <td>Poor</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1870s</td>
      <td>Good</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1880s</td>
      <td>Poor</td>
      <td>4</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1880s</td>
      <td>Average</td>
      <td>3</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1880s</td>
      <td>Good</td>
      <td>0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1890s</td>
      <td>Poor</td>
      <td>644</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1890s</td>
      <td>Average</td>
      <td>279</td>
    </tr>
    <tr>
      <th>10</th>
      <td>1890s</td>
      <td>Good</td>
      <td>19</td>
    </tr>
    <tr>
      <th>12</th>
      <td>1900s</td>
      <td>Poor</td>
      <td>955</td>
    </tr>
    <tr>
      <th>13</th>
      <td>1900s</td>
      <td>Average</td>
      <td>874</td>
    </tr>
    <tr>
      <th>14</th>
      <td>1900s</td>
      <td>Good</td>
      <td>41</td>
    </tr>
    <tr>
      <th>17</th>
      <td>1910s</td>
      <td>Average</td>
      <td>1709</td>
    </tr>
    <tr>
      <th>16</th>
      <td>1910s</td>
      <td>Poor</td>
      <td>791</td>
    </tr>
    <tr>
      <th>18</th>
      <td>1910s</td>
      <td>Good</td>
      <td>100</td>
    </tr>
    <tr>
      <th>21</th>
      <td>1920s</td>
      <td>Average</td>
      <td>2146</td>
    </tr>
    <tr>
      <th>20</th>
      <td>1920s</td>
      <td>Poor</td>
      <td>693</td>
    </tr>
    <tr>
      <th>22</th>
      <td>1920s</td>
      <td>Good</td>
      <td>355</td>
    </tr>
    <tr>
      <th>25</th>
      <td>1930s</td>
      <td>Average</td>
      <td>5445</td>
    </tr>
    <tr>
      <th>24</th>
      <td>1930s</td>
      <td>Poor</td>
      <td>1910</td>
    </tr>
    <tr>
      <th>26</th>
      <td>1930s</td>
      <td>Good</td>
      <td>866</td>
    </tr>
    <tr>
      <th>29</th>
      <td>1940s</td>
      <td>Average</td>
      <td>5717</td>
    </tr>
    <tr>
      <th>28</th>
      <td>1940s</td>
      <td>Poor</td>
      <td>1298</td>
    </tr>
    <tr>
      <th>30</th>
      <td>1940s</td>
      <td>Good</td>
      <td>1043</td>
    </tr>
    <tr>
      <th>33</th>
      <td>1950s</td>
      <td>Average</td>
      <td>6957</td>
    </tr>
    <tr>
      <th>32</th>
      <td>1950s</td>
      <td>Poor</td>
      <td>1790</td>
    </tr>
    <tr>
      <th>34</th>
      <td>1950s</td>
      <td>Good</td>
      <td>1638</td>
    </tr>
    <tr>
      <th>37</th>
      <td>1960s</td>
      <td>Average</td>
      <td>8372</td>
    </tr>
    <tr>
      <th>36</th>
      <td>1960s</td>
      <td>Poor</td>
      <td>2830</td>
    </tr>
    <tr>
      <th>38</th>
      <td>1960s</td>
      <td>Good</td>
      <td>2487</td>
    </tr>
    <tr>
      <th>41</th>
      <td>1970s</td>
      <td>Average</td>
      <td>9599</td>
    </tr>
    <tr>
      <th>40</th>
      <td>1970s</td>
      <td>Poor</td>
      <td>4788</td>
    </tr>
    <tr>
      <th>42</th>
      <td>1970s</td>
      <td>Good</td>
      <td>2933</td>
    </tr>
    <tr>
      <th>45</th>
      <td>1980s</td>
      <td>Average</td>
      <td>10919</td>
    </tr>
    <tr>
      <th>44</th>
      <td>1980s</td>
      <td>Poor</td>
      <td>5658</td>
    </tr>
    <tr>
      <th>46</th>
      <td>1980s</td>
      <td>Good</td>
      <td>3677</td>
    </tr>
    <tr>
      <th>49</th>
      <td>1990s</td>
      <td>Average</td>
      <td>12880</td>
    </tr>
    <tr>
      <th>48</th>
      <td>1990s</td>
      <td>Poor</td>
      <td>7607</td>
    </tr>
    <tr>
      <th>50</th>
      <td>1990s</td>
      <td>Good</td>
      <td>4334</td>
    </tr>
    <tr>
      <th>53</th>
      <td>2000s</td>
      <td>Average</td>
      <td>22943</td>
    </tr>
    <tr>
      <th>52</th>
      <td>2000s</td>
      <td>Poor</td>
      <td>12497</td>
    </tr>
    <tr>
      <th>54</th>
      <td>2000s</td>
      <td>Good</td>
      <td>8391</td>
    </tr>
    <tr>
      <th>57</th>
      <td>2010s</td>
      <td>Average</td>
      <td>43349</td>
    </tr>
    <tr>
      <th>58</th>
      <td>2010s</td>
      <td>Good</td>
      <td>19617</td>
    </tr>
    <tr>
      <th>56</th>
      <td>2010s</td>
      <td>Poor</td>
      <td>19197</td>
    </tr>
    <tr>
      <th>61</th>
      <td>2020s</td>
      <td>Average</td>
      <td>22302</td>
    </tr>
    <tr>
      <th>62</th>
      <td>2020s</td>
      <td>Good</td>
      <td>13678</td>
    </tr>
    <tr>
      <th>63</th>
      <td>2020s</td>
      <td>Excellent</td>
      <td>10380</td>
    </tr>
    <tr>
      <th>64</th>
      <td>2030s</td>
      <td>Poor</td>
      <td>0</td>
    </tr>
    <tr>
      <th>65</th>
      <td>2030s</td>
      <td>Average</td>
      <td>0</td>
    </tr>
    <tr>
      <th>66</th>
      <td>2030s</td>
      <td>Good</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-33069d81-a082-46f7-bf95-90bcb9deeffb')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-33069d81-a082-46f7-bf95-90bcb9deeffb button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-33069d81-a082-46f7-bf95-90bcb9deeffb');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-8e28bfa5-f20f-45a5-b23b-bb50a480508d">
      <button class="colab-df-quickchart" onclick="quickchart('df-8e28bfa5-f20f-45a5-b23b-bb50a480508d')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-8e28bfa5-f20f-45a5-b23b-bb50a480508d button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_3f7afb17-4906-4fb0-9370-9ddbb257bcc2">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('ratings_decade')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_3f7afb17-4906-4fb0-9370-9ddbb257bcc2 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('ratings_decade');
      }
      })();
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell markdown" id="2sC6qsEkIxHO">
<p>####<strong>Economical Analysis</strong></p>
</div>
<div class="cell code" data-execution_count="200"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:206}"
id="Ot08ctHrERNo" data-outputId="b63ecd95-80dc-4ddb-ce3d-37fa526621e9">
<div class="sourceCode" id="cb75"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>df1_2_filtered.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="200">

  <div id="df-5d5b21cc-d982-4985-b9c1-5b13f2531384" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>title</th>
      <th>vote_average</th>
      <th>vote_count</th>
      <th>status</th>
      <th>release_date</th>
      <th>revenue</th>
      <th>runtime</th>
      <th>budget</th>
      <th>original_language</th>
      <th>popularity</th>
      <th>genres</th>
      <th>decade</th>
      <th>profit</th>
      <th>roi</th>
      <th>genres_simplified</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Four Rooms</td>
      <td>5.869</td>
      <td>2736.0</td>
      <td>Released</td>
      <td>1995-12-09</td>
      <td>4257354.0</td>
      <td>98.0</td>
      <td>4000000.0</td>
      <td>en</td>
      <td>3.4949</td>
      <td>Comedy</td>
      <td>1990s</td>
      <td>257354.0</td>
      <td>0.064339</td>
      <td>Comedy</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Judgment Night</td>
      <td>6.500</td>
      <td>360.0</td>
      <td>Released</td>
      <td>1993-10-15</td>
      <td>12136938.0</td>
      <td>109.0</td>
      <td>21000000.0</td>
      <td>en</td>
      <td>4.2730</td>
      <td>Action, Crime, Thriller</td>
      <td>1990s</td>
      <td>-8863062.0</td>
      <td>-0.422051</td>
      <td>Action</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Dancer in the Dark</td>
      <td>7.865</td>
      <td>1891.0</td>
      <td>Released</td>
      <td>2000-09-01</td>
      <td>40061153.0</td>
      <td>140.0</td>
      <td>12500000.0</td>
      <td>en</td>
      <td>4.7205</td>
      <td>Drama, Crime</td>
      <td>2000s</td>
      <td>27561153.0</td>
      <td>2.204892</td>
      <td>Drama</td>
    </tr>
    <tr>
      <th>3</th>
      <td>The Fifth Element</td>
      <td>7.560</td>
      <td>11240.0</td>
      <td>Released</td>
      <td>1997-05-02</td>
      <td>263920180.0</td>
      <td>126.0</td>
      <td>90000000.0</td>
      <td>fr</td>
      <td>11.0271</td>
      <td>Science Fiction, Action, Adventure</td>
      <td>1990s</td>
      <td>173920180.0</td>
      <td>1.932446</td>
      <td>Science Fiction</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Metropolis</td>
      <td>8.100</td>
      <td>2945.0</td>
      <td>Released</td>
      <td>1927-02-06</td>
      <td>1350322.0</td>
      <td>153.0</td>
      <td>5300000.0</td>
      <td>de</td>
      <td>2.8329</td>
      <td>Drama, Science Fiction</td>
      <td>1920s</td>
      <td>-3949678.0</td>
      <td>-0.745222</td>
      <td>Drama</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-5d5b21cc-d982-4985-b9c1-5b13f2531384')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-5d5b21cc-d982-4985-b9c1-5b13f2531384 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-5d5b21cc-d982-4985-b9c1-5b13f2531384');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-fce7b932-c88d-417c-ad5e-f2c1d5fa1435">
      <button class="colab-df-quickchart" onclick="quickchart('df-fce7b932-c88d-417c-ad5e-f2c1d5fa1435')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-fce7b932-c88d-417c-ad5e-f2c1d5fa1435 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="201"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:457}"
id="oeBnF52oI3Ji" data-outputId="560e635c-621c-4e14-ee6a-f164b49d2728">
<div class="sourceCode" id="cb76"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co">#For Decade</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>economical_decade <span class="op">=</span> (df1_2_filtered</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>                     .groupby([<span class="st">&#39;decade&#39;</span>])[[<span class="st">&#39;budget&#39;</span>,<span class="st">&#39;revenue&#39;</span>,<span class="st">&#39;profit&#39;</span>,<span class="st">&#39;roi&#39;</span>]]</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>                     .median())</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>economical_decade</span></code></pre></div>
<div class="output execute_result" data-execution_count="201">

  <div id="df-6cde56f2-d07d-4345-b363-19ca91bd256f" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>budget</th>
      <th>revenue</th>
      <th>profit</th>
      <th>roi</th>
    </tr>
    <tr>
      <th>decade</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1910s</th>
      <td>17943.0</td>
      <td>102602.5</td>
      <td>85653.5</td>
      <td>3.840669</td>
    </tr>
    <tr>
      <th>1920s</th>
      <td>427500.0</td>
      <td>1032378.5</td>
      <td>636285.0</td>
      <td>1.861013</td>
    </tr>
    <tr>
      <th>1930s</th>
      <td>641000.0</td>
      <td>1465000.0</td>
      <td>815000.0</td>
      <td>1.280000</td>
    </tr>
    <tr>
      <th>1940s</th>
      <td>1300000.0</td>
      <td>2559000.0</td>
      <td>1300000.0</td>
      <td>1.044100</td>
    </tr>
    <tr>
      <th>1950s</th>
      <td>1465000.0</td>
      <td>3000000.0</td>
      <td>1161000.0</td>
      <td>1.142857</td>
    </tr>
    <tr>
      <th>1960s</th>
      <td>2468317.5</td>
      <td>4100000.0</td>
      <td>1323500.0</td>
      <td>1.048891</td>
    </tr>
    <tr>
      <th>1970s</th>
      <td>3000000.0</td>
      <td>6000000.0</td>
      <td>2230000.0</td>
      <td>1.103970</td>
    </tr>
    <tr>
      <th>1980s</th>
      <td>8500000.0</td>
      <td>10629029.0</td>
      <td>1909952.0</td>
      <td>0.563070</td>
    </tr>
    <tr>
      <th>1990s</th>
      <td>15000000.0</td>
      <td>14051384.0</td>
      <td>260000.0</td>
      <td>0.164444</td>
    </tr>
    <tr>
      <th>2000s</th>
      <td>11000000.0</td>
      <td>11584837.0</td>
      <td>500000.0</td>
      <td>0.205413</td>
    </tr>
    <tr>
      <th>2010s</th>
      <td>5500000.0</td>
      <td>4192590.0</td>
      <td>25449.0</td>
      <td>0.323338</td>
    </tr>
    <tr>
      <th>2020s</th>
      <td>20570.0</td>
      <td>10000.0</td>
      <td>0.0</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-6cde56f2-d07d-4345-b363-19ca91bd256f')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-6cde56f2-d07d-4345-b363-19ca91bd256f button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-6cde56f2-d07d-4345-b363-19ca91bd256f');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-84a294c7-1f7c-48f7-96f3-50ea208f3192">
      <button class="colab-df-quickchart" onclick="quickchart('df-84a294c7-1f7c-48f7-96f3-50ea208f3192')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-84a294c7-1f7c-48f7-96f3-50ea208f3192 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_cc38ee1f-3d0e-486a-a7d8-ad23114d7d1f">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('economical_decade')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_cc38ee1f-3d0e-486a-a7d8-ad23114d7d1f button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('economical_decade');
      }
      })();
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="202"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:645}"
id="4ohFjHxfKv76" data-outputId="12a54738-ffca-465a-e46a-81b750aa5439">
<div class="sourceCode" id="cb77"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co">#For Genres</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>economical_genres <span class="op">=</span> (df1_2_filtered</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>                    .groupby([<span class="st">&#39;genres_simplified&#39;</span>])[[<span class="st">&#39;budget&#39;</span>,<span class="st">&#39;revenue&#39;</span>,<span class="st">&#39;profit&#39;</span>,<span class="st">&#39;roi&#39;</span>]]</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>                    .median().reset_index()</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>                    .sort_values(by<span class="op">=</span>[<span class="st">&#39;roi&#39;</span>],ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>                    .reset_index(drop<span class="op">=</span><span class="va">True</span>))</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>economical_genres</span></code></pre></div>
<div class="output execute_result" data-execution_count="202">

  <div id="df-d332b7dc-2169-45a9-96be-2b892ec4ac9c" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>genres_simplified</th>
      <th>budget</th>
      <th>revenue</th>
      <th>profit</th>
      <th>roi</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Romance</td>
      <td>4800000.0</td>
      <td>5479646.0</td>
      <td>610570.0</td>
      <td>0.683333</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Music</td>
      <td>1990500.0</td>
      <td>2975905.5</td>
      <td>552755.0</td>
      <td>0.571913</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Comedy</td>
      <td>6131929.5</td>
      <td>6919973.0</td>
      <td>572704.0</td>
      <td>0.438084</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Family</td>
      <td>17000000.0</td>
      <td>21011500.0</td>
      <td>2645491.0</td>
      <td>0.436669</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Fantasy</td>
      <td>13000000.0</td>
      <td>12662948.0</td>
      <td>1573338.0</td>
      <td>0.390000</td>
    </tr>
    <tr>
      <th>5</th>
      <td>TV Movie</td>
      <td>51500.0</td>
      <td>4250.0</td>
      <td>102.5</td>
      <td>0.366667</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Action</td>
      <td>10946000.0</td>
      <td>10238296.5</td>
      <td>206089.5</td>
      <td>0.366016</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Western</td>
      <td>4200000.0</td>
      <td>4000000.0</td>
      <td>500000.0</td>
      <td>0.342857</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Horror</td>
      <td>3500000.0</td>
      <td>2543216.0</td>
      <td>4000.0</td>
      <td>0.333333</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Crime</td>
      <td>7000000.0</td>
      <td>6420842.0</td>
      <td>230000.0</td>
      <td>0.274328</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Adventure</td>
      <td>13250000.0</td>
      <td>10550000.0</td>
      <td>451823.0</td>
      <td>0.246775</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Science Fiction</td>
      <td>8644500.0</td>
      <td>5043454.5</td>
      <td>7.5</td>
      <td>0.147024</td>
    </tr>
    <tr>
      <th>12</th>
      <td>War</td>
      <td>6600000.0</td>
      <td>3637940.0</td>
      <td>260.0</td>
      <td>0.129023</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Thriller</td>
      <td>5650000.0</td>
      <td>3300000.0</td>
      <td>90.0</td>
      <td>0.111118</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Drama</td>
      <td>4296680.0</td>
      <td>2800000.0</td>
      <td>10.0</td>
      <td>0.065833</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Mystery</td>
      <td>3000000.0</td>
      <td>1671196.0</td>
      <td>1.0</td>
      <td>0.007407</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Animation</td>
      <td>5400000.0</td>
      <td>3489983.5</td>
      <td>0.0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Documentary</td>
      <td>5000.0</td>
      <td>2000.0</td>
      <td>0.0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>18</th>
      <td>History</td>
      <td>12000000.0</td>
      <td>5409537.5</td>
      <td>-260179.5</td>
      <td>-0.175732</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-d332b7dc-2169-45a9-96be-2b892ec4ac9c')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-d332b7dc-2169-45a9-96be-2b892ec4ac9c button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-d332b7dc-2169-45a9-96be-2b892ec4ac9c');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-e4c79c7b-a36d-4626-99c9-38b185f9897f">
      <button class="colab-df-quickchart" onclick="quickchart('df-e4c79c7b-a36d-4626-99c9-38b185f9897f')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-e4c79c7b-a36d-4626-99c9-38b185f9897f button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_fcc7db11-a4ea-4d73-95c5-6f3de3968d32">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('economical_genres')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_fcc7db11-a4ea-4d73-95c5-6f3de3968d32 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('economical_genres');
      }
      })();
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="203"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:426}"
id="Dg_apLP3-Ig_" data-outputId="7a17355f-40dc-449d-83e4-3764e9c5a964">
<div class="sourceCode" id="cb78"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Genre with most profit per decade</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>most_profit_decade <span class="op">=</span> (df1_2_filtered</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>                      .groupby([<span class="st">&#39;decade&#39;</span>,<span class="st">&#39;genres_simplified&#39;</span>])[<span class="st">&#39;roi&#39;</span>]</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>                      .median().reset_index()</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>                      .sort_values(by<span class="op">=</span>[<span class="st">&#39;decade&#39;</span>,<span class="st">&#39;roi&#39;</span>],ascending<span class="op">=</span>[<span class="va">True</span>,<span class="va">False</span>])</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>                      .groupby(<span class="st">&#39;decade&#39;</span>).head(<span class="dv">1</span>).reset_index(drop<span class="op">=</span><span class="va">True</span>))</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>most_profit_decade</span></code></pre></div>
<div class="output execute_result" data-execution_count="203">

  <div id="df-834b563c-1747-4aeb-820a-dbd5c3b88c17" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>decade</th>
      <th>genres_simplified</th>
      <th>roi</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1910s</td>
      <td>Western</td>
      <td>5.765321</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1920s</td>
      <td>Horror</td>
      <td>6.787515</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1930s</td>
      <td>Crime</td>
      <td>2.426152</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1940s</td>
      <td>Horror</td>
      <td>3.622684</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1950s</td>
      <td>Family</td>
      <td>8.089759</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1960s</td>
      <td>Science Fiction</td>
      <td>2.760911</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1970s</td>
      <td>Horror</td>
      <td>2.899758</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1980s</td>
      <td>History</td>
      <td>1.589099</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1990s</td>
      <td>TV Movie</td>
      <td>7.400000</td>
    </tr>
    <tr>
      <th>9</th>
      <td>2000s</td>
      <td>Music</td>
      <td>2.480376</td>
    </tr>
    <tr>
      <th>10</th>
      <td>2010s</td>
      <td>Romance</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>11</th>
      <td>2020s</td>
      <td>TV Movie</td>
      <td>0.375000</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-834b563c-1747-4aeb-820a-dbd5c3b88c17')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-834b563c-1747-4aeb-820a-dbd5c3b88c17 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-834b563c-1747-4aeb-820a-dbd5c3b88c17');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-243993e7-1bd3-4a1a-b539-cae3be132359">
      <button class="colab-df-quickchart" onclick="quickchart('df-243993e7-1bd3-4a1a-b539-cae3be132359')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-243993e7-1bd3-4a1a-b539-cae3be132359 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_f840c08f-8fc1-4216-afa4-882151867954">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('most_profit_decade')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_f840c08f-8fc1-4216-afa4-882151867954 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('most_profit_decade');
      }
      })();
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="204"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:426}"
id="95UT3LsiBzg4" data-outputId="deea0e74-45a6-4acf-e2c9-eef312de29f9">
<div class="sourceCode" id="cb79"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Genre with most budget per decade</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>most_budget_decade <span class="op">=</span> (df1_2_filtered</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>                      .groupby([<span class="st">&#39;decade&#39;</span>,<span class="st">&#39;genres_simplified&#39;</span>])[<span class="st">&#39;budget&#39;</span>]</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>                      .median().reset_index()</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>                      .sort_values(by<span class="op">=</span>[<span class="st">&#39;decade&#39;</span>,<span class="st">&#39;budget&#39;</span>],</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>                                   ascending<span class="op">=</span>[<span class="va">True</span>,<span class="va">False</span>])</span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>                      .groupby(<span class="st">&#39;decade&#39;</span>).head(<span class="dv">1</span>).reset_index(drop<span class="op">=</span><span class="va">True</span>))</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>most_budget_decade <span class="op">=</span>pd.DataFrame(most_budget_decade)</span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>most_budget_decade</span></code></pre></div>
<div class="output execute_result" data-execution_count="204">

  <div id="df-217a2ac8-e2be-4e42-bf31-7a5aaa44732a" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>decade</th>
      <th>genres_simplified</th>
      <th>budget</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1910s</td>
      <td>Fantasy</td>
      <td>501500.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1920s</td>
      <td>Action</td>
      <td>750000.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1930s</td>
      <td>Adventure</td>
      <td>1932500.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1940s</td>
      <td>Music</td>
      <td>2402161.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1950s</td>
      <td>History</td>
      <td>5000000.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1960s</td>
      <td>History</td>
      <td>11000000.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1970s</td>
      <td>War</td>
      <td>15000000.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1980s</td>
      <td>History</td>
      <td>24500000.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1990s</td>
      <td>History</td>
      <td>33000000.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>2000s</td>
      <td>Adventure</td>
      <td>30000000.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>2010s</td>
      <td>Family</td>
      <td>17400000.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>2020s</td>
      <td>History</td>
      <td>15000000.0</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-217a2ac8-e2be-4e42-bf31-7a5aaa44732a')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-217a2ac8-e2be-4e42-bf31-7a5aaa44732a button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-217a2ac8-e2be-4e42-bf31-7a5aaa44732a');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-a0803112-be77-43a0-940f-64c876875ee0">
      <button class="colab-df-quickchart" onclick="quickchart('df-a0803112-be77-43a0-940f-64c876875ee0')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-a0803112-be77-43a0-940f-64c876875ee0 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_76c2c8e9-46e5-471f-9749-3eb7c7f9dbbf">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('most_budget_decade')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_76c2c8e9-46e5-471f-9749-3eb7c7f9dbbf button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('most_budget_decade');
      }
      })();
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell markdown" id="TbqHtPj0PVR6">
<p>####<strong>IMDB Ratings</strong></p>
</div>
<div class="cell code" data-execution_count="205"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:571}"
id="3tPPoT89PZW0" data-outputId="8f12a397-ac8c-41cb-cf16-3c9b8675b547">
<div class="sourceCode" id="cb80"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>df2.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="205">

  <div id="df-ed4eb580-fe43-48f4-8fc6-0f9c7c4204a3" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>title</th>
      <th>status</th>
      <th>release_date</th>
      <th>runtime</th>
      <th>original_language</th>
      <th>genres</th>
      <th>production_countries</th>
      <th>cast</th>
      <th>director</th>
      <th>imdb_rating</th>
      <th>imdb_votes</th>
      <th>release_year</th>
      <th>decade</th>
      <th>rating_bins</th>
      <th>genres_simplified</th>
      <th>cast_count</th>
      <th>runtime_bins</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Ariel</td>
      <td>Released</td>
      <td>1988-10-21</td>
      <td>73.0</td>
      <td>fi</td>
      <td>Comedy, Drama, Romance, Crime</td>
      <td>Finland</td>
      <td>Susanna Haavisto, Pentti Auer, Olli Varja, Mer...</td>
      <td>Aki Kaurismäki</td>
      <td>7.4</td>
      <td>9426.0</td>
      <td>1988</td>
      <td>1980s</td>
      <td>Good</td>
      <td>Comedy</td>
      <td>39</td>
      <td>Short</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Shadows in Paradise</td>
      <td>Released</td>
      <td>1986-10-17</td>
      <td>74.0</td>
      <td>fi</td>
      <td>Comedy, Drama, Romance</td>
      <td>Finland</td>
      <td>Kylli Köngäs, Esko Nikkari, Marina Martinoff, ...</td>
      <td>Aki Kaurismäki</td>
      <td>7.4</td>
      <td>8276.0</td>
      <td>1986</td>
      <td>1980s</td>
      <td>Good</td>
      <td>Comedy</td>
      <td>33</td>
      <td>Short</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Four Rooms</td>
      <td>Released</td>
      <td>1995-12-09</td>
      <td>98.0</td>
      <td>en</td>
      <td>Comedy</td>
      <td>United States of America</td>
      <td>Lawrence Bender, Valeria Golino, Jennifer Beal...</td>
      <td>Robert Rodriguez, Allison Anders, Quentin Tara...</td>
      <td>6.7</td>
      <td>115301.0</td>
      <td>1995</td>
      <td>1990s</td>
      <td>Average</td>
      <td>Comedy</td>
      <td>28</td>
      <td>Standard</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Judgment Night</td>
      <td>Released</td>
      <td>1993-10-15</td>
      <td>109.0</td>
      <td>en</td>
      <td>Action, Crime, Thriller</td>
      <td>United States of America</td>
      <td>Doug Wert, Angela Alvarado, Everlast, Sean O'G...</td>
      <td>Stephen Hopkins</td>
      <td>6.6</td>
      <td>20447.0</td>
      <td>1993</td>
      <td>1990s</td>
      <td>Average</td>
      <td>Action</td>
      <td>31</td>
      <td>Standard</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Sunday in August</td>
      <td>Released</td>
      <td>2004-09-02</td>
      <td>15.0</td>
      <td>de</td>
      <td>Drama</td>
      <td>Germany</td>
      <td>Rita Lengyel, Milton Welsh</td>
      <td>Anna Haas, Marc Meyer</td>
      <td>6.8</td>
      <td>14.0</td>
      <td>2004</td>
      <td>2000s</td>
      <td>Average</td>
      <td>Drama</td>
      <td>2</td>
      <td>Short</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-ed4eb580-fe43-48f4-8fc6-0f9c7c4204a3')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-ed4eb580-fe43-48f4-8fc6-0f9c7c4204a3 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-ed4eb580-fe43-48f4-8fc6-0f9c7c4204a3');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-e0acb2df-b4e5-4e6d-b55c-92352b8e8715">
      <button class="colab-df-quickchart" onclick="quickchart('df-e0acb2df-b4e5-4e6d-b55c-92352b8e8715')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-e0acb2df-b4e5-4e6d-b55c-92352b8e8715 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>

</div>
</div>
<div class="cell markdown" id="RApqdW0iCX0w">
<p>We will enrich our dataframe with 1 more column called weighted
rating. It's very useful as movies with low count of votes, such as 5
votes and rating 10, can outperform movies with thousands of votes.</p>
</div>
<div class="cell code" data-execution_count="206" id="vZqGT39KDBsa">
<div class="sourceCode" id="cb81"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Weighted Average</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>df2[<span class="st">&#39;weighted_rating&#39;</span>]<span class="op">=</span>df2[<span class="st">&#39;imdb_rating&#39;</span>]<span class="op">*</span>df2[<span class="st">&#39;imdb_votes&#39;</span>]</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="207"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:574}"
id="VvCNpNqwPfCg" data-outputId="6565dd84-bb00-4299-fb6c-43033de6073b">
<div class="sourceCode" id="cb82"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Real Decade Rating</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>decade_rating <span class="op">=</span>(df2</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>                .groupby([<span class="st">&#39;decade&#39;</span>])</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>                .<span class="bu">apply</span>(<span class="kw">lambda</span> x: (x[<span class="st">&#39;imdb_rating&#39;</span>]<span class="op">*</span>x[<span class="st">&#39;imdb_votes&#39;</span>]) <span class="co">#Calculating the weighted average per decade</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>                .<span class="bu">sum</span>()<span class="op">/</span>(x[<span class="st">&#39;imdb_votes&#39;</span>]).<span class="bu">sum</span>())</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>                .reset_index(name<span class="op">=</span><span class="st">&#39;decade_rating&#39;</span>))</span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>decade_rating</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/tmp/ipython-input-891210880.py:4: DeprecationWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda x: (x[&#39;imdb_rating&#39;]*x[&#39;imdb_votes&#39;]) #Calculating the weighted average per decade
</code></pre>
</div>
<div class="output execute_result" data-execution_count="207">

  <div id="df-88577033-4510-4e31-b3e4-6cf9b46b739e" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>decade</th>
      <th>decade_rating</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1880s</td>
      <td>5.500000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1890s</td>
      <td>6.049069</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1900s</td>
      <td>6.567901</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1910s</td>
      <td>6.314923</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1920s</td>
      <td>7.476365</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1930s</td>
      <td>7.286107</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1940s</td>
      <td>7.444787</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1950s</td>
      <td>7.499152</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1960s</td>
      <td>7.418973</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1970s</td>
      <td>7.498635</td>
    </tr>
    <tr>
      <th>10</th>
      <td>1980s</td>
      <td>7.189256</td>
    </tr>
    <tr>
      <th>11</th>
      <td>1990s</td>
      <td>7.281948</td>
    </tr>
    <tr>
      <th>12</th>
      <td>2000s</td>
      <td>6.984014</td>
    </tr>
    <tr>
      <th>13</th>
      <td>2010s</td>
      <td>6.884818</td>
    </tr>
    <tr>
      <th>14</th>
      <td>2020s</td>
      <td>6.571486</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-88577033-4510-4e31-b3e4-6cf9b46b739e')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-88577033-4510-4e31-b3e4-6cf9b46b739e button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-88577033-4510-4e31-b3e4-6cf9b46b739e');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-018b2e50-c113-4b09-a874-c040707e9ece">
      <button class="colab-df-quickchart" onclick="quickchart('df-018b2e50-c113-4b09-a874-c040707e9ece')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-018b2e50-c113-4b09-a874-c040707e9ece button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_d6247a27-6d5d-40b6-98e0-3861eb5725b7">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('decade_rating')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_d6247a27-6d5d-40b6-98e0-3861eb5725b7 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('decade_rating');
      }
      })();
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="208"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:510}"
id="lGBdYs8_PfKY" data-outputId="0fd4edee-2bf7-424a-db0f-68664c82b0fc">
<div class="sourceCode" id="cb84"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Decade&#39;s Best movie per Genre</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>df3 <span class="op">=</span> pd.DataFrame((df2</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>                   .groupby([<span class="st">&#39;decade&#39;</span>,<span class="st">&#39;genres_simplified&#39;</span>])</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>                      .<span class="bu">apply</span>(<span class="kw">lambda</span> x:</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>                      x.sort_values(by<span class="op">=</span>[<span class="st">&#39;weighted_rating&#39;</span>],ascending<span class="op">=</span>[<span class="va">False</span>])</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>                      .head(<span class="dv">1</span>), include_groups<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>                  [[<span class="st">&#39;title&#39;</span>,<span class="st">&#39;imdb_rating&#39;</span>,<span class="st">&#39;production_countries&#39;</span>]]))</span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>df3</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/tmp/ipython-input-2065041078.py:4: DeprecationWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda x:
</code></pre>
</div>
<div class="output execute_result" data-execution_count="208">

  <div id="df-bd296984-129f-4202-8864-a9581b4346f4" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th></th>
      <th>title</th>
      <th>imdb_rating</th>
      <th>production_countries</th>
    </tr>
    <tr>
      <th>decade</th>
      <th>genres_simplified</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1880s</th>
      <th>Documentary</th>
      <th>53305</th>
      <td>Accordion Player</td>
      <td>5.5</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">1890s</th>
      <th>Action</th>
      <th>83001</th>
      <td>The Hornbacker-Murphy Fight</td>
      <td>4.9</td>
      <td>United States of America</td>
    </tr>
    <tr>
      <th>Animation</th>
      <th>83367</th>
      <td>Guillaume Tell</td>
      <td>4.8</td>
      <td>France</td>
    </tr>
    <tr>
      <th>Comedy</th>
      <th>47182</th>
      <td>The Sprinkler Sprinkled</td>
      <td>7.1</td>
      <td>France</td>
    </tr>
    <tr>
      <th>Crime</th>
      <th>73720</th>
      <td>Chinese Laundry Scene</td>
      <td>5.6</td>
      <td>United States of America</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">2020s</th>
      <th>Science Fiction</th>
      <th>162487</th>
      <td>Dune</td>
      <td>8.0</td>
      <td>United States of America</td>
    </tr>
    <tr>
      <th>TV Movie</th>
      <th>280915</th>
      <td>Mountainhead</td>
      <td>5.4</td>
      <td>United States of America</td>
    </tr>
    <tr>
      <th>Thriller</th>
      <th>196275</th>
      <td>The Invisible Man</td>
      <td>7.1</td>
      <td>Australia, United States of America</td>
    </tr>
    <tr>
      <th>War</th>
      <th>28950</th>
      <td>All Quiet on the Western Front</td>
      <td>7.8</td>
      <td>Germany</td>
    </tr>
    <tr>
      <th>Western</th>
      <th>206279</th>
      <td>The Harder They Fall</td>
      <td>6.6</td>
      <td>United States of America</td>
    </tr>
  </tbody>
</table>
<p>259 rows × 3 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-bd296984-129f-4202-8864-a9581b4346f4')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-bd296984-129f-4202-8864-a9581b4346f4 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-bd296984-129f-4202-8864-a9581b4346f4');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-a771764a-89c2-458e-9f76-f2cfe6792818">
      <button class="colab-df-quickchart" onclick="quickchart('df-a771764a-89c2-458e-9f76-f2cfe6792818')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-a771764a-89c2-458e-9f76-f2cfe6792818 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_07fec728-37c4-48f2-b3ab-14f30d7d96de">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('df3')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_07fec728-37c4-48f2-b3ab-14f30d7d96de button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('df3');
      }
      })();
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell markdown" id="cC_tGYmhU4lM">
<p>The user can try diffrent indexxes to check the best movies for each
genre for each decade. Don't forget that the above indexxes are objects
and we will use .loc. An exaple follows.</p>
</div>
<div class="cell code" data-execution_count="209"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:677}"
id="ijMNFnw9PfPY" data-outputId="9be3581a-9fed-46cf-fd80-9c756f55e5a4">
<div class="sourceCode" id="cb86"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Example - Best 80s Movies</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>df3.loc[<span class="st">&#39;1980s&#39;</span>]</span></code></pre></div>
<div class="output execute_result" data-execution_count="209">

  <div id="df-2baae173-f832-4bdd-a682-08846ba9ab42" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>title</th>
      <th>imdb_rating</th>
      <th>production_countries</th>
    </tr>
    <tr>
      <th>genres_simplified</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Action</th>
      <th>434</th>
      <td>Die Hard</td>
      <td>8.2</td>
      <td>United States of America</td>
    </tr>
    <tr>
      <th>Adventure</th>
      <th>1248</th>
      <td>The Empire Strikes Back</td>
      <td>8.7</td>
      <td>United States of America</td>
    </tr>
    <tr>
      <th>Animation</th>
      <th>6933</th>
      <td>Grave of the Fireflies</td>
      <td>8.5</td>
      <td>Japan</td>
    </tr>
    <tr>
      <th>Comedy</th>
      <th>487</th>
      <td>Ghostbusters</td>
      <td>7.8</td>
      <td>United States of America</td>
    </tr>
    <tr>
      <th>Crime</th>
      <th>186</th>
      <td>Stand by Me</td>
      <td>8.1</td>
      <td>United States of America</td>
    </tr>
    <tr>
      <th>Documentary</th>
      <th>1160</th>
      <td>Roger &amp; Me</td>
      <td>7.5</td>
      <td>United States of America</td>
    </tr>
    <tr>
      <th>Drama</th>
      <th>469</th>
      <td>Full Metal Jacket</td>
      <td>8.2</td>
      <td>United Kingdom, United States of America</td>
    </tr>
    <tr>
      <th>Family</th>
      <th>6758</th>
      <td>The Land Before Time</td>
      <td>7.4</td>
      <td>United States of America, Ireland</td>
    </tr>
    <tr>
      <th>Fantasy</th>
      <th>3932</th>
      <td>My Neighbor Totoro</td>
      <td>8.1</td>
      <td>Japan</td>
    </tr>
    <tr>
      <th>History</th>
      <th>228</th>
      <td>Amadeus</td>
      <td>8.4</td>
      <td>United States of America</td>
    </tr>
    <tr>
      <th>Horror</th>
      <th>557</th>
      <td>The Shining</td>
      <td>8.4</td>
      <td>United Kingdom, United States of America</td>
    </tr>
    <tr>
      <th>Music</th>
      <th>403</th>
      <td>The Blues Brothers</td>
      <td>7.9</td>
      <td>United States of America</td>
    </tr>
    <tr>
      <th>Mystery</th>
      <th>626</th>
      <td>Blue Velvet</td>
      <td>7.7</td>
      <td>United States of America</td>
    </tr>
    <tr>
      <th>Romance</th>
      <th>4365</th>
      <td>Romancing the Stone</td>
      <td>6.9</td>
      <td>United States of America, Mexico</td>
    </tr>
    <tr>
      <th>Science Fiction</th>
      <th>43</th>
      <td>Blade Runner</td>
      <td>8.1</td>
      <td>United States of America, Hong Kong, United Ki...</td>
    </tr>
    <tr>
      <th>TV Movie</th>
      <th>18176</th>
      <td>Made in Britain</td>
      <td>7.2</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>Thriller</th>
      <th>693</th>
      <td>WarGames</td>
      <td>7.1</td>
      <td>United States of America</td>
    </tr>
    <tr>
      <th>War</th>
      <th>4972</th>
      <td>Heartbreak Ridge</td>
      <td>6.8</td>
      <td>United States of America</td>
    </tr>
    <tr>
      <th>Western</th>
      <th>4112</th>
      <td>Pale Rider</td>
      <td>7.3</td>
      <td>United States of America</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-2baae173-f832-4bdd-a682-08846ba9ab42')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-2baae173-f832-4bdd-a682-08846ba9ab42 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-2baae173-f832-4bdd-a682-08846ba9ab42');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-f5f36090-5617-4b56-bf62-86a0f18ba5a1">
      <button class="colab-df-quickchart" onclick="quickchart('df-f5f36090-5617-4b56-bf62-86a0f18ba5a1')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-f5f36090-5617-4b56-bf62-86a0f18ba5a1 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>

</div>
</div>
<div class="cell markdown" id="7kDc9ee8woG4">
<p>##<strong>Step 6: Visualization</strong> At this step we will
visualize most of the preceding results.</p>
</div>
<div class="cell markdown" id="ndKfY1vnxCnf">
<p>###<strong>Visualizations for general analysis</strong></p>
</div>
<div class="cell code" data-execution_count="210"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:0}"
id="kyUjaa4bw4eo" data-outputId="15fadf2d-4a3b-4ef1-a0bc-e782a215c717">
<div class="sourceCode" id="cb87"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating Figure with 2 Subplots</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">30</span>,<span class="fl">22.5</span>))</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>ax1 <span class="op">=</span> fig.add_subplot(<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> fig.add_subplot(<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>ax3 <span class="op">=</span> fig.add_subplot(<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">3</span>)</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating Barplot Movies per Decade</span></span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>sns.barplot(data<span class="op">=</span>movies_per_decade.iloc[<span class="dv">0</span>:<span class="dv">16</span>,:], ax<span class="op">=</span>ax1, x<span class="op">=</span><span class="st">&#39;decade&#39;</span>, y<span class="op">=</span><span class="st">&#39;count&#39;</span>)</span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">&#39;Number of Movies&#39;</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">&#39;Decade&#39;</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">&#39;Movies per Decade&#39;</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating Barplot Median Time per Decade from 1920&#39;s up to now</span></span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a>sns.barplot(data<span class="op">=</span>median_time.loc[<span class="st">&#39;1920s&#39;</span>:<span class="st">&#39;2020s&#39;</span>],</span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a>            ax<span class="op">=</span>ax2, x<span class="op">=</span>median_time.loc[<span class="st">&#39;1920s&#39;</span>:<span class="st">&#39;2020s&#39;</span>].index,</span>
<span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a>            y<span class="op">=</span><span class="st">&#39;runtime&#39;</span>, color<span class="op">=</span><span class="st">&#39;peru&#39;</span>)</span>
<span id="cb87-17"><a href="#cb87-17" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">&#39;Median Time&#39;</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb87-18"><a href="#cb87-18" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="st">&#39;Decade&#39;</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb87-19"><a href="#cb87-19" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">&#39;Median Time from 1920s up to now&#39;</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb87-20"><a href="#cb87-20" aria-hidden="true" tabindex="-1"></a>ax2.set_ylim(<span class="dv">35</span>,<span class="dv">88</span>)</span>
<span id="cb87-21"><a href="#cb87-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-22"><a href="#cb87-22" aria-hidden="true" tabindex="-1"></a><span class="co">#Top Genres From 80&#39;s to now from production numbers</span></span>
<span id="cb87-23"><a href="#cb87-23" aria-hidden="true" tabindex="-1"></a>sns.barplot(data<span class="op">=</span>top_genres.iloc[<span class="dv">30</span>:<span class="dv">45</span>,:], ax<span class="op">=</span>ax3, x<span class="op">=</span><span class="st">&#39;decade&#39;</span>, y<span class="op">=</span><span class="st">&#39;count&#39;</span>,</span>
<span id="cb87-24"><a href="#cb87-24" aria-hidden="true" tabindex="-1"></a>            hue<span class="op">=</span><span class="st">&#39;genres_simplified&#39;</span>,width<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb87-25"><a href="#cb87-25" aria-hidden="true" tabindex="-1"></a>ax3.set_ylabel(<span class="st">&#39;Production Number&#39;</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb87-26"><a href="#cb87-26" aria-hidden="true" tabindex="-1"></a>ax3.set_xlabel(<span class="st">&#39;Decade&#39;</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb87-27"><a href="#cb87-27" aria-hidden="true" tabindex="-1"></a>ax3.set_title(<span class="st">&#39;Top 3 Genres From 80s to now According to Production Numbers&#39;</span>,</span>
<span id="cb87-28"><a href="#cb87-28" aria-hidden="true" tabindex="-1"></a>              fontsize<span class="op">=</span><span class="dv">16</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="210">
<pre><code>Text(0.5, 1.0, &#39;Top 3 Genres From 80s to now According to Production Numbers&#39;)</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_4d6dfe57ac424568a203d712cd33ef8c/aeacd2da46b7b132788b4b801dea403bca7f6fe6.png" /></p>
</div>
</div>
<div class="cell markdown" id="ubvMtW4g_EL4">
<p>###<strong>Economical Analysis</strong></p>
</div>
<div class="cell code" data-execution_count="211"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:1000}"
id="l05Wbyz0w4hG" data-outputId="f6bde33d-9655-481f-cd0f-b8968af6c176">
<div class="sourceCode" id="cb89"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Budget Revenue and ROI per Decade based on Median</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>fig<span class="op">=</span>plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>,<span class="dv">14</span>))</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>ax1<span class="op">=</span>fig.add_subplot(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>ax2<span class="op">=</span>fig.add_subplot(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Budget And Revenue</span></span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>sns.barplot(data<span class="op">=</span>economical_decade, ax<span class="op">=</span>ax1, x<span class="op">=</span>economical_decade.index,</span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>            y<span class="op">=</span><span class="st">&#39;budget&#39;</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, saturation<span class="op">=</span><span class="dv">1</span>,color<span class="op">=</span><span class="st">&#39;cornflowerblue&#39;</span>,</span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>            label<span class="op">=</span><span class="st">&#39;budget&#39;</span>)</span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>sns.barplot(data<span class="op">=</span>economical_decade, ax<span class="op">=</span>ax1, x<span class="op">=</span>economical_decade.index,</span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a>            y<span class="op">=</span><span class="st">&#39;revenue&#39;</span>, color<span class="op">=</span><span class="st">&#39;coral&#39;</span>, alpha<span class="op">=</span><span class="fl">0.5</span>, saturation<span class="op">=</span><span class="fl">0.2</span>,</span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a>            label<span class="op">=</span><span class="st">&#39;revenue&#39;</span>)</span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a>ax1.legend(loc<span class="op">=</span><span class="st">&#39;best&#39;</span>)</span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">&#39;Decade&#39;</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">&#39;Money&#39;</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb89-16"><a href="#cb89-16" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">&#39;Budget and Revenue per Decade&#39;</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb89-17"><a href="#cb89-17" aria-hidden="true" tabindex="-1"></a>ax1.annotate(<span class="st">&#39;Most Profitable Decade&#39;</span>,</span>
<span id="cb89-18"><a href="#cb89-18" aria-hidden="true" tabindex="-1"></a>             xy<span class="op">=</span>(economical_decade.index[<span class="dv">6</span>],economical_decade.iloc[<span class="dv">6</span>,<span class="dv">1</span>]),</span>
<span id="cb89-19"><a href="#cb89-19" aria-hidden="true" tabindex="-1"></a>             xytext<span class="op">=</span>(economical_decade.index[<span class="dv">6</span>],</span>
<span id="cb89-20"><a href="#cb89-20" aria-hidden="true" tabindex="-1"></a>                     economical_decade.iloc[<span class="dv">7</span>,<span class="dv">1</span>]<span class="op">+</span><span class="dv">2</span><span class="op">*</span><span class="dv">10</span><span class="op">**</span><span class="dv">6</span>),</span>
<span id="cb89-21"><a href="#cb89-21" aria-hidden="true" tabindex="-1"></a>             arrowprops<span class="op">=</span><span class="bu">dict</span>(facecolor<span class="op">=</span><span class="st">&#39;black&#39;</span>,headwidth<span class="op">=</span><span class="dv">4</span>,width<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb89-22"><a href="#cb89-22" aria-hidden="true" tabindex="-1"></a>                             headlength<span class="op">=</span><span class="dv">4</span>),</span>
<span id="cb89-23"><a href="#cb89-23" aria-hidden="true" tabindex="-1"></a>             fontsize<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb89-24"><a href="#cb89-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-25"><a href="#cb89-25" aria-hidden="true" tabindex="-1"></a><span class="co">#ROI</span></span>
<span id="cb89-26"><a href="#cb89-26" aria-hidden="true" tabindex="-1"></a>sns.lineplot(data<span class="op">=</span>economical_decade, ax<span class="op">=</span>ax2, x<span class="op">=</span><span class="st">&#39;decade&#39;</span>,y<span class="op">=</span><span class="st">&#39;roi&#39;</span>)</span>
<span id="cb89-27"><a href="#cb89-27" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="st">&#39;Decade&#39;</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb89-28"><a href="#cb89-28" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">&#39;ROI&#39;</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb89-29"><a href="#cb89-29" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">&#39;ROI per Decade&#39;</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="211">
<pre><code>Text(0.5, 1.0, &#39;ROI per Decade&#39;)</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_4d6dfe57ac424568a203d712cd33ef8c/9f51e5124aca5f922177f169cdaeadc3904d00a9.png" /></p>
</div>
</div>
<div class="cell markdown" id="nmIfNZIjqSaY">
<p>The most profitable decade is actually 1910's with ROI 3,84 however
we focus in the analysis from 1920's and onwards that's why we select
1970s.</p>
</div>
<div class="cell code" data-execution_count="212"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:1000}"
id="Pa3mcQWm_MW1" data-outputId="767f7233-6238-46ba-947a-92d6984a525b">
<div class="sourceCode" id="cb91"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Budget and Revenue per Genre</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>fig<span class="op">=</span>plt.figure(figsize<span class="op">=</span>(<span class="dv">25</span>,<span class="dv">15</span>))</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>ax1<span class="op">=</span>fig.add_subplot(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>economical_genres.plot(kind<span class="op">=</span><span class="st">&#39;bar&#39;</span>,</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>                       x<span class="op">=</span><span class="st">&#39;genres_simplified&#39;</span>,</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>                       y<span class="op">=</span>[<span class="st">&#39;budget&#39;</span>,<span class="st">&#39;revenue&#39;</span>],</span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>                       width<span class="op">=</span><span class="fl">0.9</span>, ax<span class="op">=</span>ax1)</span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">&#39;Genre&#39;</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">&#39;Money&#39;</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">&#39;Budget and Revenue per Genre&#39;</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="212">
<pre><code>Text(0.5, 1.0, &#39;Budget and Revenue per Genre&#39;)</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_4d6dfe57ac424568a203d712cd33ef8c/e4f37e480ff07828a161390b4739765452ff5058.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="213"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:896}"
id="De8v6ZYO_MZN" data-outputId="0a2d54bf-3f54-42d5-f0db-fddb5e55ad25">
<div class="sourceCode" id="cb93"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Genre with most budget per Decade</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>fig<span class="op">=</span>plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>,<span class="dv">10</span>))</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>ax1<span class="op">=</span>fig.add_subplot(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>sns.barplot(data<span class="op">=</span>most_budget_decade,</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>                        x<span class="op">=</span><span class="st">&#39;decade&#39;</span>,</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>                        y<span class="op">=</span><span class="st">&#39;budget&#39;</span>,</span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>                        width<span class="op">=</span><span class="fl">0.9</span>, ax<span class="op">=</span>ax1, hue<span class="op">=</span><span class="st">&#39;genres_simplified&#39;</span>)</span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">&#39;Decade&#39;</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">&#39;Money&#39;</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">&#39;Genre with most budget per Decade&#39;</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="213">
<pre><code>Text(0.5, 1.0, &#39;Genre with most budget per Decade&#39;)</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_4d6dfe57ac424568a203d712cd33ef8c/579f08f65f68a6a21577c1201e9d0561feba0a3e.png" /></p>
</div>
</div>
<div class="cell markdown" id="OgAqjHFcReJi">
<p>###<strong>IMDB Rating</strong></p>
</div>
<div class="cell markdown" id="rRyKN39LYQLJ">
<p>As this is the last subsection of visualization, we will make 3
barplots corresponding to the best movies of 80s, 90s and 00s of each
genre according to the previous analysis. We must not forget that we
performed a weighted rating on each movie (votes*rating) as we will get
more accurate results. This happens as a movie rated with 9 by 3 people,
can outperform a movie with rating 7 with thousands of votes.</p>
</div>
<div class="cell code" data-execution_count="214"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:1000}"
id="AXOJO8mGRheN" data-outputId="e8beefc6-5678-4ac7-e3f1-9ebb1c655de4">
<div class="sourceCode" id="cb95"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Best 80s Movies according IMDB (weighted votes)</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>sns.color_palette(<span class="st">&#39;pastel&#39;</span>,<span class="dv">19</span>)</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>fig<span class="op">=</span>plt.figure(figsize<span class="op">=</span>(<span class="dv">25</span>,<span class="dv">35</span>))</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>ax1<span class="op">=</span>fig.add_subplot(<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>ax2<span class="op">=</span>fig.add_subplot(<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>ax3<span class="op">=</span>fig.add_subplot(<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">3</span>)</span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Barplots</span></span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>sns.barplot(data<span class="op">=</span>df3.loc[<span class="st">&#39;1980s&#39;</span>],</span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>            x<span class="op">=</span><span class="st">&#39;title&#39;</span>,</span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a>            y<span class="op">=</span><span class="st">&#39;imdb_rating&#39;</span>,</span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a>            hue<span class="op">=</span><span class="st">&#39;genres_simplified&#39;</span>,</span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a>            width<span class="op">=</span><span class="fl">0.9</span>, ax<span class="op">=</span>ax1)</span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-15"><a href="#cb95-15" aria-hidden="true" tabindex="-1"></a>sns.barplot(data<span class="op">=</span>df3.loc[<span class="st">&#39;1990s&#39;</span>],</span>
<span id="cb95-16"><a href="#cb95-16" aria-hidden="true" tabindex="-1"></a>            x<span class="op">=</span><span class="st">&#39;title&#39;</span>,</span>
<span id="cb95-17"><a href="#cb95-17" aria-hidden="true" tabindex="-1"></a>            y<span class="op">=</span><span class="st">&#39;imdb_rating&#39;</span>,</span>
<span id="cb95-18"><a href="#cb95-18" aria-hidden="true" tabindex="-1"></a>            hue<span class="op">=</span><span class="st">&#39;genres_simplified&#39;</span>,</span>
<span id="cb95-19"><a href="#cb95-19" aria-hidden="true" tabindex="-1"></a>            width<span class="op">=</span><span class="fl">0.9</span>, ax<span class="op">=</span>ax2)</span>
<span id="cb95-20"><a href="#cb95-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-21"><a href="#cb95-21" aria-hidden="true" tabindex="-1"></a>sns.barplot(data<span class="op">=</span>df3.loc[<span class="st">&#39;2000s&#39;</span>],</span>
<span id="cb95-22"><a href="#cb95-22" aria-hidden="true" tabindex="-1"></a>            x<span class="op">=</span><span class="st">&#39;title&#39;</span>,</span>
<span id="cb95-23"><a href="#cb95-23" aria-hidden="true" tabindex="-1"></a>            y<span class="op">=</span><span class="st">&#39;imdb_rating&#39;</span>,</span>
<span id="cb95-24"><a href="#cb95-24" aria-hidden="true" tabindex="-1"></a>            hue<span class="op">=</span><span class="st">&#39;genres_simplified&#39;</span>,</span>
<span id="cb95-25"><a href="#cb95-25" aria-hidden="true" tabindex="-1"></a>            width<span class="op">=</span><span class="fl">0.9</span>, ax<span class="op">=</span>ax3)</span>
<span id="cb95-26"><a href="#cb95-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-27"><a href="#cb95-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-28"><a href="#cb95-28" aria-hidden="true" tabindex="-1"></a><span class="co">#Customizations for every subplot</span></span>
<span id="cb95-29"><a href="#cb95-29" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">&#39;IMDB Rating&#39;</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb95-30"><a href="#cb95-30" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">&#39;Best 80s Movies according to IMDB (weighted votes)&#39;</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb95-31"><a href="#cb95-31" aria-hidden="true" tabindex="-1"></a>ax1.set_xticklabels(ax1.get_xticklabels(), rotation<span class="op">=</span><span class="dv">30</span>, fontsize<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb95-32"><a href="#cb95-32" aria-hidden="true" tabindex="-1"></a>ax1.set_ylim(<span class="fl">6.5</span>,<span class="fl">9.5</span>)</span>
<span id="cb95-33"><a href="#cb95-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-34"><a href="#cb95-34" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="st">&#39;Title&#39;</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb95-35"><a href="#cb95-35" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">&#39;IMDB Rating&#39;</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb95-36"><a href="#cb95-36" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">&#39;Best 90s Movies according to IMDB (weighted votes)&#39;</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb95-37"><a href="#cb95-37" aria-hidden="true" tabindex="-1"></a>ax2.set_xticklabels(ax2.get_xticklabels(), rotation<span class="op">=</span><span class="dv">30</span>, fontsize<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb95-38"><a href="#cb95-38" aria-hidden="true" tabindex="-1"></a>ax2.set_ylim(<span class="fl">6.5</span>,<span class="fl">9.5</span>)</span>
<span id="cb95-39"><a href="#cb95-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-40"><a href="#cb95-40" aria-hidden="true" tabindex="-1"></a>ax3.set_xlabel(<span class="st">&#39;Title&#39;</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb95-41"><a href="#cb95-41" aria-hidden="true" tabindex="-1"></a>ax3.set_ylabel(<span class="st">&#39;IMDB Rating&#39;</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb95-42"><a href="#cb95-42" aria-hidden="true" tabindex="-1"></a>ax3.set_title(<span class="st">&#39;Best 00s Movies according to IMDB (weighted votes)&#39;</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb95-43"><a href="#cb95-43" aria-hidden="true" tabindex="-1"></a>ax3.set_xticklabels(ax3.get_xticklabels(), rotation<span class="op">=</span><span class="dv">45</span>, fontsize<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb95-44"><a href="#cb95-44" aria-hidden="true" tabindex="-1"></a>ax3.set_ylim(<span class="fl">6.0</span>,<span class="fl">9.5</span>)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/tmp/ipython-input-2067139714.py:31: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax1.set_xticklabels(ax1.get_xticklabels(), rotation=30, fontsize=8)
/tmp/ipython-input-2067139714.py:37: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax2.set_xticklabels(ax2.get_xticklabels(), rotation=30, fontsize=8)
/tmp/ipython-input-2067139714.py:43: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax3.set_xticklabels(ax3.get_xticklabels(), rotation=45, fontsize=8)
</code></pre>
</div>
<div class="output execute_result" data-execution_count="214">
<pre><code>(6.0, 9.5)</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_4d6dfe57ac424568a203d712cd33ef8c/6c9d23b2b08ce62332ed8325a0cced3149ee3b74.png" /></p>
</div>
</div>
<div class="cell markdown" id="I58L9Ly5bnv6">
<p>##<strong>Step 7: Conclusion</strong></p>
<p>Through this exploratory analysis, we examined the evolution and
characteristics of a movies dataset across decades, focusing on
qualitative features such as Genres and Numerical Features (Budget,
Revenue, Runtime, ROI) and their statistical behavior.</p>
<p><strong>Key Findings</strong></p>
<p>From a sample of 639.024 movies:</p>
<ul>
<li>There is a geometric increase of produced movies from 90's up to
2010's.</li>
<li>While in 20's Century the most movies produced per decade followed
the pattern Documentary-Comedy-Drama we can spot a change from 00's to
Documentary-Drama-Comedy.</li>
<li>The longest in runtime movies were produced in 80s and 90s with a
median time 86 minutes then there is a continous drop for the decades
following.</li>
</ul>
<p>From a sample of 13.256 movies where they have been filtered from
outliers in budget and revenue resulting in a remaining sample of 12.537
movies:</p>
<ul>
<li>The decade with biggest budget and revenue was the 90s</li>
<li>The most profitable decade was the 70's</li>
<li>The Biggest ROI was given in 1910's</li>
<li>The movie genre with the biggest budget, revenue and profit is
'Family'.</li>
<li>The genre with biggest ROI per decade is 'TV Movie'. During the
1990s, the “TV Movie” genre showed the highest median ROI (~7.4) among
all categories in the dataset. Although the sample size is small (n =
1), this result aligns with the economic context of the era — television
productions typically had very low budgets but stable revenue streams
from broadcasting rights and home video sales. Therefore, while the
result should be interpreted with caution due to limited data
availability, it plausibly reflects the high investment efficiency of
'TV movies' during the 1990s, rather than being a statistical
anomaly.</li>
<li>The biggest budget per decade per genre of all time was in 90's for
'History' movies (movies like Braveheart) with a median value of 33
million followed by 30 million 'Adventure' Genre in 00's.</li>
</ul>
</div>
</body>
</html>
